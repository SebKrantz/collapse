<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fast Transform and Compute Columns on a Data Frame — ftransform • collapse</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fast Transform and Compute Columns on a Data Frame — ftransform"><meta property="og:description" content="ftransform is a much faster version of transform for data frames. It returns the data frame with new columns computed and/or existing columns modified or deleted. settransform does all of that by reference. fcompute computes and returns new columns. These functions evaluate all arguments simultaneously, allow list-input (nested pipelines) and disregard grouped data.
Catering to the tidyverse user, v1.7.0 introduced fmutate, providing familiar functionality i.e. arguments are evaluated sequentially, computation on grouped data is done by groups, and functions can be applied to multiple columns using across. See also the Details."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" class="external-link">Blog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/collapse_R" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast Transform and Compute Columns on a Data Frame</h1>
    
    <div class="hidden name"><code>ftransform.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>ftransform</code> is a much faster version of <code><a href="https://Rdatatable.gitlab.io/data.table/reference/transform.data.table.html" class="external-link">transform</a></code> for data frames. It returns the data frame with new columns computed and/or existing columns modified or deleted. <code>settransform</code> does all of that by reference. <code>fcompute</code> computes and returns new columns. These functions evaluate all arguments simultaneously, allow list-input (nested pipelines) and disregard grouped data.</p>
<p>Catering to the <em>tidyverse</em> user, v1.7.0 introduced <code>fmutate</code>, providing familiar functionality i.e. arguments are evaluated sequentially, computation on grouped data is done by groups, and functions can be applied to multiple columns using <code><a href="across.html">across</a></code>. See also the Details.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Modify and return data frame</span></span>
<span><span class="fu">ftransform</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">ftransformv</span><span class="op">(</span><span class="va">.data</span>, <span class="va">vars</span>, <span class="va">FUN</span>, <span class="va">...</span>, apply <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">tfm</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span><span class="op">)</span>               <span class="co"># Shorthand for ftransform</span></span>
<span><span class="fu">tfmv</span><span class="op">(</span><span class="va">.data</span>, <span class="va">vars</span>, <span class="va">FUN</span>, <span class="va">...</span>, apply <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Modify data frame by reference</span></span>
<span><span class="fu">settransform</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">settransformv</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span><span class="op">)</span>     <span class="co"># Same arguments as ftransformv</span></span>
<span><span class="fu">settfm</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span><span class="op">)</span>            <span class="co"># Shorthand for settransform</span></span>
<span><span class="fu">settfmv</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Replace/add modified columns in/to a data frame</span></span>
<span><span class="fu">ftransform</span><span class="op">(</span><span class="va">.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span><span class="fu">tfm</span><span class="op">(</span><span class="va">.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>           <span class="co"># Shorthand for ftransform&lt;-</span></span>
<span></span>
<span><span class="co"># Compute columns, returned as a new data frame</span></span>
<span><span class="fu">fcompute</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span>, keep <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">fcomputev</span><span class="op">(</span><span class="va">.data</span>, <span class="va">vars</span>, <span class="va">FUN</span>, <span class="va">...</span>, apply <span class="op">=</span> <span class="cn">TRUE</span>, keep <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># New: dplyr-style mutate (sequential evaluation + across() feature)</span></span>
<span><span class="fu">fmutate</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span>, .keep <span class="op">=</span> <span class="st">"all"</span>, .cols <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">mtt</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span>, .keep <span class="op">=</span> <span class="st">"all"</span>, .cols <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># Shorthand for fmutate</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.data</dt>
<dd><p>a data frame or named list of columns.</p></dd>

    <dt>...</dt>
<dd><p>further arguments of the form <code>column = value</code>. The <code>value</code> can be a combination of other columns, a scalar value, or <code>NULL</code>, which deletes <code>column</code>. Alternatively it is also possible to place a single list here, which will be treated like a list of <code>column = value</code> arguments. For <code>ftransformv</code> and <code>fcomputev</code>, <code>...</code> can be used to pass further arguments to <code>FUN</code>. The ellipsis (<code>...</code>) is always evaluated within the data frame (<code>.data</code>) environment. See Examples.
<code>fmutate</code> additionally supports <code><a href="across.html">across</a></code> statements, and evaluates tagged vector expressions sequentially. With grouped execution, <code>dots</code> can also contain arbitrary expressions that result in a list of data-length columns. See Examples.</p></dd>

    <dt>vars</dt>
<dd><p>variables to be transformed by applying <code>FUN</code> to them: select using names, indices, a logical vector or a selector function (e.g. <code>is.numeric</code>). Since v1.7 <code>vars</code> is evaluated within the <code>.data</code> environment, permitting expressions on columns e.g. <code>c(col1, col3:coln)</code>.</p></dd>

    <dt>FUN</dt>
<dd><p>a single function yielding a result of length <code>NROW(.data)</code> or 1. See also <code>apply</code>.</p></dd>

    <dt>apply</dt>
<dd><p>logical. <code>TRUE</code> (default) will apply <code>FUN</code> to each column selected in <code>vars</code>; <code>FALSE</code> will apply <code>FUN</code> to the subsetted data frame i.e. <code>FUN(get_vars(.data, vars), ...)</code>. The latter is useful for <em>collapse</em> functions with data frame or grouped / panel data frame methods, yielding performance gains and enabling grouped transformations. See Examples.</p></dd>

    <dt>value</dt>
<dd><p>a named list of replacements, it will be treated like an evaluated list of <code>column = value</code> arguments.</p></dd>

    <dt>keep</dt>
<dd><p>select columns to preserve using column names, indices or a function (e.g. <code>is.numeric</code>). By default computed columns are added after the preserved ones, unless they are assigned the same name in which case the preserved columns will be replaced in order.</p></dd>

   <dt>.keep</dt>
<dd><p>either one of <code>"all", "used", "unused"</code> or <code>"none"</code> (see <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></code>), or columns names/indices/function as <code>keep</code>. <em>Note</em> that this does not work well with <code><a href="across.html">across()</a></code> or other expressions supported since v1.9.0. The only sensible option you have there is to supply a character vector of all columns in the final dataset that you want to keep.</p></dd>


   <dt>.cols</dt>
<dd><p>for expressions involving <code>.data</code>, <code>.cols</code> can be used to subset columns, e.g. <code>mtcars |&gt; gby(cyl) |&gt; mtt(broom::augment(lm(mpg ~., .data)), .cols = 1:7)</code>. Can pass column names, indices, a logical vector or a selector function (e.g. <code>is.numericr</code>).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>...</code> arguments to <code>ftransform</code> are tagged
  vector expressions, which are evaluated in the data frame
  <code>.data</code>.  The tags are matched against <code>names(.data)</code>, and for
  those that match, the values replace the corresponding variable in
  <code>.data</code>, whereas the others are appended to <code>.data</code>. It is also possible to delete columns by assigning <code>NULL</code> to them, i.e. <code>ftransform(data, colk = NULL)</code> removes <code>colk</code> from the data. <em>Note</em> that <code>names(.data)</code> and the names of the <code>...</code> arguments are checked for uniqueness beforehand, yielding an error if this is not the case.</p>
<p>Since <em>collapse</em> v1.3.0, is is also possible to pass a single named list to <code>...</code>, i.e. <code>ftransform(data, newdata)</code>. This list will be treated like a list of tagged vector expressions. <em>Note</em> the different behavior: <code>ftransform(data, list(newcol = col1))</code> is the same as <code>ftransform(data, newcol = col1)</code>, whereas <code>ftransform(data, newcol = as.list(col1))</code> creates a list column. Something like <code>ftransform(data, as.list(col1))</code> gives an error because the list is not named. See Examples.   <!-- % and \code{ftransform(data, as.list(col1))} gives an error because an unnamed list is passed. % , but \code{ftransform(data, setNames(as.list(col1), col1))} will work and add the values of \code{col1} as separate columns. --></p>
<p><!-- % \code{ftransform(data, fmean(list(col1mean = col1, col2mean = col2), drop = FALSE))} etc. --></p>
<p><!-- % For example \code{ftransformv(data, 1:3, log)} is the same as \code{ftransform(data, lapply(get_vars(data, 1:3), log))}, and \code{ftransformv(data, 1:3, log, apply = FALSE)} is the same as \code{ftransform(data, log(get_vars(data, 1:3)))}. --></p>
<p>The function <code>ftransformv</code> added in v1.3.2 provides a fast replacement for the functions <code><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">dplyr::mutate_at</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">dplyr::mutate_if</a></code> (without the grouping feature) facilitating mutations of groups of columns (<code><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">dplyr::mutate_all</a></code> is already accounted for by <code><a href="dapply.html">dapply</a></code>). See Examples.</p>
<p>The function <code>settransform</code> does all of that by reference, but uses base-R's copy-on modify semantics, which is equivalent to replacing the data with <code>&lt;-</code> (thus it is still memory efficient but the data will have a different memory address afterwards).</p>
<p>The function <code>fcompute(v)</code> works just like <code>ftransform(v)</code>, but returns only the changed / computed columns without modifying or appending the data in <code>.data</code>. See Examples.</p>
<p>The function <code>fmutate</code> added in v1.7.0, provides functionality familiar from <em>dplyr</em> 1.0.0 and higher. It evaluates tagged vector expressions sequentially and does operations by groups on a grouped frame (thus it is slower than <code>ftransform</code> if you have many tagged expressions or a grouped data frame). Note however that <em>collapse</em> does not depend on <em>rlang</em>, so things like lambda expressions are not available. <em>Note also</em> that <code>fmutate</code> operates differently on grouped data whether you use <code>.FAST_FUN</code> or base R functions / functions from other packages. With <code>.FAST_FUN</code> (including <code>.OPERATOR_FUN</code>, excluding <code>fhdbetween</code> / <code>fhdwithin</code> / <code>HDW</code> / <code>HDB</code>), <code>fmutate</code> performs an efficient vectorized execution, i.e. the grouping object from the grouped data frame is passed to the <code>g</code> argument of these functions, and for <code>.FAST_STAT_FUN</code> also <code>TRA = "replace_fill"</code> is set (if not overwritten by the user), yielding internal grouped computation by these functions without the need for splitting the data by groups. For base R and other functions, <code>fmutate</code> performs classical split-apply combine computing i.e. the relevant columns of the data are selected and split into groups, the expression is evaluated for each group, and the result is recombined and suitably expanded to match the original data frame. <b>Note</b> that it is not possible to mix vectorized and standard execution in the same expression!! Vectorized execution is performed if <b>any</b> <code>.FAST_FUN</code> or <code>.OPERATOR_FUN</code> is part of the expression, thus a code like <code>mtcars |&gt; gby(cyl) |&gt; fmutate(new = fmin(mpg) / min(mpg))</code> will be expanded to something like <code>mtcars %&gt;% gby(cyl) %&gt;% ftransform(new = fmin(mpg, g = GRP(.), TRA = "replace_fill") / min(mpg))</code> and then executed, i.e. <code>fmin(mpg)</code> will be executed in a vectorized way, and <code>min(mpg)</code> will not be executed by groups at all.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p><code>ftransform</code> ignores grouped data. This is on purpose as it allows non-grouped transformation inside a pipeline on grouped data, and affords greater flexibility and performance in programming with the <code>.FAST_FUN</code>. In particular, you can run a nested pipeline inside <code>ftransform</code>, and decide which expressions should be grouped, and you can use the ad-hoc grouping functionality of the <code>.FAST_FUN</code>, allowing operations where different groupings are applied simultaneously in an expression. See Examples or the answer provided <a href="https://stackoverflow.com/questions/67349744/using-ftransform-along-with-fgroup-by-from-collapse-r-package" class="external-link">here</a>.</p>
<p><code>fmutate</code> on the other hand supports grouped operations just like <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate</a></code>, but works in two different ways depending on whether you use <code>.FAST_FUN</code> in an expression or other functions. See the Examples.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>The modified data frame <code>.data</code>, or, for <code>fcompute</code>, a new data frame with the columns computed on <code>.data</code>. All attributes of <code>.data</code> are preserved.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="across.html">across</a></code>, <code><a href="fsummarise.html">fsummarise</a></code>, <a href="fast-data-manipulation.html">Data Frame Manipulation</a>, <a href="index.html">Collapse Overview</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fmutate() examples ---------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Please note that expressions are vectorized whenever they contain 'ANY' fast function</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">vs</span>, <span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">fmutate</span><span class="op">(</span>mean_mpg <span class="op">=</span> <span class="fu"><a href="fmean.html">fmean</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>,                     <span class="co"># Vectorized</span></span></span>
<span class="r-in"><span>          mean_mpg_base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>,                 <span class="co"># Non-vectorized</span></span></span>
<span class="r-in"><span>          mpg_cumpr <span class="op">=</span> <span class="fu"><a href="fcumsum.html">fcumsum</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="fsum.html">fsum</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>,      <span class="co"># Vectorized</span></span></span>
<span class="r-in"><span>          mpg_cumpr_base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>,   <span class="co"># Non-vectorized</span></span></span>
<span class="r-in"><span>          mpg_cumpr_mixed <span class="op">=</span> <span class="fu"><a href="fcumsum.html">fcumsum</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="co"># Vectorized: division by overall sum</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 mpg cyl disp  hp drat    wt  qsec vs am gear carb mean_mpg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4      21.0   6  160 110 3.90 2.620 16.46  0  1    4    4 20.56667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag  21.0   6  160 110 3.90 2.875 17.02  0  1    4    4 20.56667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710     22.8   4  108  93 3.85 2.320 18.61  1  1    4    1 28.37143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1 19.12500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                mean_mpg_base mpg_cumpr mpg_cumpr_base mpg_cumpr_mixed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           20.56667 0.3403566      0.3403566      0.03266449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       20.56667 0.6807131      0.6807131      0.06532898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710          28.37143 0.1148036      0.1148036      0.03546430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      19.12500 0.2797386      0.2797386      0.03328667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 28 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using across: here fmean() gets vectorized across both groups and columns (requiring a single</span></span></span>
<span class="r-in"><span><span class="co"># call to fmean.data.frame which goes to C), whereas weighted.mean needs to be called many times.</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">vs</span>, <span class="va">am</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">fmutate</span><span class="op">(</span><span class="fu"><a href="across.html">across</a></span><span class="op">(</span><span class="va">disp</span><span class="op">:</span><span class="va">qsec</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">fmean</span>, mu2 <span class="op">=</span> <span class="va">weighted.mean</span><span class="op">)</span>, w <span class="op">=</span> <span class="va">wt</span>, .names <span class="op">=</span> <span class="st">"flip"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                mpg cyl disp  hp drat    wt  qsec vs am gear carb  mu_disp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4     21.0   6  160 110 3.90 2.620 16.46  0  1    4    4 154.9728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4 154.9728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710    22.8   4  108  93 3.85 2.320 18.61  1  1    4    1  92.2352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               mu2_disp     mu_hp    mu2_hp  mu_drat mu2_drat    mu_wt   mu2_wt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4     154.9728 131.78463 131.78463 3.806158 3.806158 2.758975 2.758975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag 154.9728 131.78463 131.78463 3.806158 3.806158 2.758975 2.758975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710     92.2352  82.11819  82.11819 4.130037 4.130037 2.110131 2.110131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                mu_qsec mu2_qsec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4     16.33306 16.33306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag 16.33306 16.33306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710    18.75509 18.75509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 29 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Can do more complex things...</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">fmutate</span><span class="op">(</span>res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">carb</span> <span class="op">+</span> <span class="va">hp</span>, weights <span class="op">=</span> <span class="va">wt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl disp  hp drat    wt  qsec vs am gear carb       res</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4  1.125008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4  1.125008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1 -2.716748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1  1.870410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2  2.229621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 27 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl  [3 | 11 (3.5) 7-14] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Since v1.9.0: supports arbitrary expressions returning suitable lists</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">fmutate</span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu">augment</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">carb</span> <span class="op">+</span> <span class="va">hp</span>, weights <span class="op">=</span> <span class="va">wt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same thing using across() (supported before 1.9.0)</span></span></span>
<span class="r-in"><span><span class="va">modelfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu">augment</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">carb</span> <span class="op">+</span> <span class="va">hp</span>, <span class="va">data</span>, weights <span class="op">=</span> <span class="va">wt</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">fmutate</span><span class="op">(</span><span class="fu"><a href="across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">carb</span>, <span class="va">hp</span>, <span class="va">wt</span><span class="op">)</span>, <span class="va">modelfun</span>, .apply <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ftransform() / fcompute() examples: ----------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ftransform modifies and returns a data.frame</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransform</span><span class="op">(</span><span class="va">airquality</span>, Ozone <span class="op">=</span> <span class="op">-</span><span class="va">Ozone</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   -41     190  7.4   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   -36     118  8.0   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -12     149 12.6   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   -18     313 11.5   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -28      NA 14.9   66     5   6</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransform</span><span class="op">(</span><span class="va">airquality</span>, new <span class="op">=</span> <span class="op">-</span><span class="va">Ozone</span>, Temp <span class="op">=</span> <span class="op">(</span><span class="va">Temp</span><span class="op">-</span><span class="fl">32</span><span class="op">)</span><span class="op">/</span><span class="fl">1.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind     Temp Month Day new</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4 19.44444     5   1 -41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0 22.22222     5   2 -36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6 23.33333     5   3 -12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5 16.66667     5   4 -18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3 13.33333     5   5  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9 18.88889     5   6 -28</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransform</span><span class="op">(</span><span class="va">airquality</span>, new <span class="op">=</span> <span class="op">-</span><span class="va">Ozone</span>, new2 <span class="op">=</span> <span class="fl">1</span>, Temp <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Deleting Temp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Month Day new new2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4     5   1 -41    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0     5   2 -36    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6     5   3 -12    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5     5   4 -18    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3     5   5  NA    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9     5   6 -28    1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransform</span><span class="op">(</span><span class="va">airquality</span>, Ozone <span class="op">=</span> <span class="cn">NULL</span>, Temp <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>            <span class="co"># Deleting columns</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Solar.R Wind Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     190  7.4     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     118  8.0     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     149 12.6     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     313 11.5     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      NA 14.3     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      NA 14.9     5   6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With collapse's grouped and weighted functions, complex operations are done on the fly</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransform</span><span class="op">(</span><span class="va">airquality</span>, <span class="co"># Grouped operations by month:</span></span></span>
<span class="r-in"><span>                Ozone_Month_median <span class="op">=</span> <span class="fu"><a href="fnth_fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">Ozone</span>, <span class="va">Month</span>, TRA <span class="op">=</span> <span class="st">"replace_fill"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                Ozone_Month_sd <span class="op">=</span> <span class="fu"><a href="fvar_fsd.html">fsd</a></span><span class="op">(</span><span class="va">Ozone</span>, <span class="va">Month</span>, TRA <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                Ozone_Month_centered <span class="op">=</span> <span class="fu"><a href="fbetween_fwithin.html">fwithin</a></span><span class="op">(</span><span class="va">Ozone</span>, <span class="va">Month</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day Ozone_Month_median Ozone_Month_sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4   67     5   1                 18       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0   72     5   2                 18       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6   74     5   3                 18       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5   62     5   4                 18       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   56     5   5                 18             NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9   66     5   6                 18       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone_Month_centered</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            17.384615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            12.384615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           -11.615385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            -5.615385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6             4.384615</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grouping by month and above/below average temperature in each month</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransform</span><span class="op">(</span><span class="va">airquality</span>, Ozone_Month_high_median <span class="op">=</span></span></span>
<span class="r-in"><span>                  <span class="fu"><a href="fnth_fmedian.html">fmedian</a></span><span class="op">(</span><span class="va">Ozone</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Month</span>, <span class="va">Temp</span> <span class="op">&gt;</span> <span class="fu"><a href="fbetween_fwithin.html">fbetween</a></span><span class="op">(</span><span class="va">Temp</span>, <span class="va">Month</span><span class="op">)</span><span class="op">)</span>, TRA <span class="op">=</span> <span class="st">"replace_fill"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day Ozone_Month_high_median</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4   67     5   1                      28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0   72     5   2                      28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6   74     5   3                      28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5   62     5   4                      14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   56     5   5                      14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9   66     5   6                      28</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ftransformv can be used to modify multiple columns using a function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransformv</span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">log</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Ozone  Solar.R     Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.713572 5.247024 2.001480   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.583519 4.770685 2.079442   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.484907 5.003946 2.533697   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.890372 5.746203 2.442347   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       NA       NA 2.660260   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 3.332205       NA 2.701361   66     5   6</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">`[&lt;-`</span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">log</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># Same thing in base R</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Ozone  Solar.R     Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.713572 5.247024 2.001480   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.583519 4.770685 2.079442   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.484907 5.003946 2.533697   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.890372 5.746203 2.442347   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       NA       NA 2.660260   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 3.332205       NA 2.701361   66     5   6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransformv</span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">log</span>, apply <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Ozone  Solar.R     Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.713572 5.247024 2.001480   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.583519 4.770685 2.079442   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.484907 5.003946 2.533697   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.890372 5.746203 2.442347   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       NA       NA 2.660260   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 3.332205       NA 2.701361   66     5   6</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">`[&lt;-`</span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>         <span class="co"># Same thing in base R</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Ozone  Solar.R     Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.713572 5.247024 2.001480   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.583519 4.770685 2.079442   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.484907 5.003946 2.533697   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.890372 5.746203 2.442347   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       NA       NA 2.660260   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 3.332205       NA 2.701361   66     5   6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using apply = FALSE yields meaningful performance gains with collapse functions</span></span></span>
<span class="r-in"><span><span class="co"># This calls fwithin.default, and repeates the grouping by month 3 times:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransformv</span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">fwithin</span>, <span class="va">Month</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ozone    Solar.R       Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  17.384615   8.703704 -4.2225806   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  12.384615 -63.296296 -3.6225806   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -11.615385 -32.296296  0.9774194   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -5.615385 131.703704 -0.1225806   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         NA         NA  2.6774194   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   4.384615         NA  3.2774194   66     5   6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This calls fwithin.data.frame, and only groups one time -&gt; 5x faster!</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">ftransformv</span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">fwithin</span>, <span class="va">Month</span>, apply <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ozone    Solar.R       Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  17.384615   8.703704 -4.2225806   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  12.384615 -63.296296 -3.6225806   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -11.615385 -32.296296  0.9774194   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -5.615385 131.703704 -0.1225806   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         NA         NA  2.6774194   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   4.384615         NA  3.2774194   66     5   6</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># This also works for grouped and panel data frames (calling fwithin.grouped_df)</span></span></span>
<span class="r-in"><span><span class="va">airquality</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">Month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ftransformv</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">fwithin</span>, apply <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ozone    Solar.R       Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  17.384615   8.703704 -4.2225806   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  12.384615 -63.296296 -3.6225806   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -11.615385 -32.296296  0.9774194   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -5.615385 131.703704 -0.1225806   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         NA         NA  2.6774194   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   4.384615         NA  3.2774194   66     5   6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But this gives the WRONG result (calling fwithin.default). Need option apply = FALSE!!</span></span></span>
<span class="r-in"><span><span class="va">airquality</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">Month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ftransformv</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">fwithin</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Ozone    Solar.R      Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -1.12931   4.068493 -2.557516   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -6.12931 -67.931507 -1.957516   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -30.12931 -36.931507  2.642484   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -24.12931 127.068493  1.542484   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        NA         NA  4.342484   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -14.12931         NA  4.942484   66     5   6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For grouped modification of single columns in a grouped dataset, we can use GRP():</span></span></span>
<span class="r-in"><span><span class="va">airquality</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">Month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ftransform</span><span class="op">(</span>W_Ozone <span class="op">=</span> <span class="fu"><a href="fbetween_fwithin.html">fwithin</a></span><span class="op">(</span><span class="va">Ozone</span>, <span class="fu"><a href="GRP.html">GRP</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>,                 <span class="co"># Grouped centering</span></span></span>
<span class="r-in"><span>             sd_Ozone_m <span class="op">=</span> <span class="fu"><a href="fvar_fsd.html">fsd</a></span><span class="op">(</span><span class="va">Ozone</span>, <span class="fu"><a href="GRP.html">GRP</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, TRA <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span>, <span class="co"># In-Month standard deviation</span></span></span>
<span class="r-in"><span>             sd_Ozone <span class="op">=</span> <span class="fu"><a href="fvar_fsd.html">fsd</a></span><span class="op">(</span><span class="va">Ozone</span>, TRA <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span>,           <span class="co"># Overall standard deviation</span></span></span>
<span class="r-in"><span>             sd_Ozone2 <span class="op">=</span> <span class="fu"><a href="fvar_fsd.html">fsd</a></span><span class="op">(</span><span class="va">Ozone</span>, TRA <span class="op">=</span> <span class="st">"replace_fill"</span><span class="op">)</span>,     <span class="co"># Same, overwriting NA's</span></span></span>
<span class="r-in"><span>             sd_Ozone3 <span class="op">=</span> <span class="fu"><a href="fvar_fsd.html">fsd</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span>                  <span class="co"># Same thing (calling alloc())</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day    W_Ozone sd_Ozone_m sd_Ozone sd_Ozone2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4   67     5   1  17.384615   22.22445 32.98788  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0   72     5   2  12.384615   22.22445 32.98788  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6   74     5   3 -11.615385   22.22445 32.98788  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5   62     5   4  -5.615385   22.22445 32.98788  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   56     5   5         NA         NA       NA  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9   66     5   6   4.384615   22.22445 32.98788  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sd_Ozone3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  32.98788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  32.98788</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>object 'airquality' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## For more complex mutations we can use ftransform with compound pipes</span></span></span>
<span class="r-in"><span><span class="va">airquality</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">Month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ftransform</span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">fwithin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="flag.html">flag</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Ozone    Solar.R       Wind Temp Month Day   L1.Ozone  L2.Ozone</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  17.384615   8.703704 -4.2225806   67     5   1         NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  12.384615 -63.296296 -3.6225806   72     5   2  17.384615        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -11.615385 -32.296296  0.9774194   74     5   3  12.384615  17.38462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -5.615385 131.703704 -0.1225806   62     5   4 -11.615385  12.38462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         NA         NA  2.6774194   56     5   5  -5.615385 -11.61538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L1.Solar.R L2.Solar.R    L1.Wind    L2.Wind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   8.703704         NA -4.2225806         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -63.296296   8.703704 -3.6225806 -4.2225806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -32.296296 -63.296296  0.9774194 -3.6225806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 131.703704 -32.296296 -0.1225806  0.9774194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">airquality</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ftransform</span><span class="op">(</span><span class="fu"><a href="fscale.html">STD</a></span><span class="op">(</span><span class="va">.</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recode-replace.html">replace_NA</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day   STD.Ozone STD.Solar.R   STD.Wind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4   67     5   1 -0.03423409  0.04517615 -0.7259482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0   72     5   2 -0.18580489 -0.75430487 -0.5556388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6   74     5   3 -0.91334473 -0.41008388  0.7500660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5   62     5   4 -0.73145977  1.41095624  0.4378323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   56     5   5  0.00000000  0.00000000  1.2326091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9   66     5   6 -0.42831817  0.00000000  1.4029185</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The list argument feature also allows flexible operations creating multiple new columns</span></span></span>
<span class="r-in"><span><span class="va">airquality</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># The variance of Wind and Ozone, by month, weighted by temperature:</span></span></span>
<span class="r-in"><span>  <span class="fu">ftransform</span><span class="op">(</span><span class="fu"><a href="fvar_fsd.html">fvar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Wind_var <span class="op">=</span> <span class="va">Wind</span>, Ozone_var <span class="op">=</span> <span class="va">Ozone</span><span class="op">)</span>, <span class="va">Month</span>, <span class="va">Temp</span>, <span class="st">"replace"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day Wind_var Ozone_var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4   67     5   1 12.08975  533.2819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0   72     5   2 12.08975  533.2819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6   74     5   3 12.08975  533.2819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5   62     5   4 12.08975  533.2819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   56     5   5 12.08975        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9   66     5   6 12.08975  533.2819</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above using a grouped data frame (a bit more complex)</span></span></span>
<span class="r-in"><span><span class="va">airquality</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">Month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ftransform</span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">fselect</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">Wind</span>, <span class="va">Ozone</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fvar_fsd.html">fvar</a></span><span class="op">(</span><span class="va">Temp</span>, <span class="st">"replace"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="small-helpers.html">add_stub</a></span><span class="op">(</span><span class="st">"_var"</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="va">fungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day Wind_var Ozone_var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4   67     5   1 12.08975  533.2819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0   72     5   2 12.08975  533.2819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6   74     5   3 12.08975  533.2819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5   62     5   4 12.08975  533.2819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   56     5   5 12.08975        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9   66     5   6 12.08975  533.2819</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This performs 2 different multi-column grouped operations (need c() to make it one list)</span></span></span>
<span class="r-in"><span><span class="fu">ftransform</span><span class="op">(</span><span class="va">airquality</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="fnth_fmedian.html">fmedian</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Wind_Day_median <span class="op">=</span> <span class="va">Wind</span>,</span></span>
<span class="r-in"><span>                                      Ozone_Day_median <span class="op">=</span> <span class="va">Ozone</span><span class="op">)</span>, <span class="va">Day</span>, TRA <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         <span class="fu"><a href="fvar_fsd.html">fsd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Wind_Month_sd <span class="op">=</span> <span class="va">Wind</span>,</span></span>
<span class="r-in"><span>                                  Ozone_Month_sd <span class="op">=</span> <span class="va">Ozone</span><span class="op">)</span>, <span class="va">Month</span>, TRA <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day Wind_Day_median Ozone_Day_median</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4   67     5   1             6.9             68.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0   72     5   2             9.2             42.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6   74     5   3             9.2             24.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5   62     5   4             9.2             78.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   56     5   5             7.4               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9   66     5   6            14.3             36.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Wind_Month_sd Ozone_Month_sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       3.53145       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       3.53145       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       3.53145       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       3.53145       22.22445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       3.53145             NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       3.53145       22.22445</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## settransform(v) works like ftransform(v) but modifies a data frame in the global environment..</span></span></span>
<span class="r-in"><span><span class="fu">settransform</span><span class="op">(</span><span class="va">airquality</span>, Ratio <span class="op">=</span> <span class="va">Ozone</span> <span class="op">/</span> <span class="va">Temp</span>, Ozone <span class="op">=</span> <span class="cn">NULL</span>, Temp <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Solar.R Wind Month Day     Ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     190  7.4     5   1 0.6119403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     118  8.0     5   2 0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     149 12.6     5   3 0.1621622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     313 11.5     5   4 0.2903226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      NA 14.3     5   5        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      NA 14.9     5   6 0.4242424</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grouped and weighted centering</span></span></span>
<span class="r-in"><span><span class="fu">settransformv</span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">fwithin</span>, <span class="va">Month</span>, <span class="va">Temp</span>, apply <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Ozone    Solar.R        Wind Temp Month Day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  16.22536   3.571669 -4.08917323   67     5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  11.22536 -68.428331 -3.48917323   72     5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -12.77464 -37.428331  1.11082677   74     5   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -6.77464 126.571669  0.01082677   62     5   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        NA         NA  2.81082677   56     5   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   3.22536         NA  3.41082677   66     5   6</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Suitably lagged first-differences</span></span></span>
<span class="r-in"><span><span class="fu">settransform</span><span class="op">(</span><span class="va">airquality</span>, <span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">fdiff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="flag.html">flag</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day L1.Ozone L2.Ozone L1.Solar.R L2.Solar.R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    NA      NA   NA   67     5   1       NA       NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    -5     -72  0.6   72     5   2       NA       NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -24      31  4.6   74     5   3       -5       NA        -72         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     6     164 -1.1   62     5   4      -24       -5         31        -72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA  2.8   56     5   5        6      -24        164         31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L1.Wind L2.Wind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.6      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4.6     0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    -1.1     4.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above using magrittr::`%&lt;&gt;%`</span></span></span>
<span class="r-in"><span><span class="va">airquality</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu">ftransform</span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">fdiff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="flag.html">flag</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day L1.Ozone L2.Ozone L1.Solar.R L2.Solar.R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    NA      NA   NA   67     5   1       NA       NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    -5     -72  0.6   72     5   2       NA       NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -24      31  4.6   74     5   3       -5       NA        -72         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     6     164 -1.1   62     5   4      -24       -5         31        -72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA  2.8   56     5   5        6      -24        164         31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L1.Wind L2.Wind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.6      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4.6     0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    -1.1     4.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It is also possible to achieve the same thing via a replacement method (if needed)</span></span></span>
<span class="r-in"><span><span class="fu">ftransform</span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">airquality</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">fdiff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="flag.html">flag</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind Temp Month Day L1.Ozone L2.Ozone L1.Solar.R L2.Solar.R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    NA      NA   NA   67     5   1       NA       NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    -5     -72  0.6   72     5   2       NA       NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -24      31  4.6   74     5   3       -5       NA        -72         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     6     164 -1.1   62     5   4      -24       -5         31        -72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA  2.8   56     5   5        6      -24        164         31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L1.Wind L2.Wind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.6      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4.6     0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    -1.1     4.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fcompute only returns the modified / computed columns</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcompute</span><span class="op">(</span><span class="va">airquality</span>, Ozone <span class="op">=</span> <span class="op">-</span><span class="va">Ozone</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   -41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   -36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   -18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -28</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcompute</span><span class="op">(</span><span class="va">airquality</span>, new <span class="op">=</span> <span class="op">-</span><span class="va">Ozone</span>, Temp <span class="op">=</span> <span class="op">(</span><span class="va">Temp</span><span class="op">-</span><span class="fl">32</span><span class="op">)</span><span class="op">/</span><span class="fl">1.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   new     Temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -41 19.44444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -36 22.22222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -12 23.33333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -18 16.66667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  NA 13.33333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -28 18.88889</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcompute</span><span class="op">(</span><span class="va">airquality</span>, new <span class="op">=</span> <span class="op">-</span><span class="va">Ozone</span>, new2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   new new2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -41    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -36    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -12    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -18    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  NA    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -28    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Can preserve existing columns, computed ones are added to the right if names are different</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcompute</span><span class="op">(</span><span class="va">airquality</span>, new <span class="op">=</span> <span class="op">-</span><span class="va">Ozone</span>, new2 <span class="op">=</span> <span class="fl">1</span>, keep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind new new2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    41     190  7.4 -41    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    36     118  8.0 -36    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    12     149 12.6 -12    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    18     313 11.5 -18    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3  NA    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    28      NA 14.9 -28    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If given same name as preserved columns, preserved columns are replaced in order...</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcompute</span><span class="op">(</span><span class="va">airquality</span>, Ozone <span class="op">=</span> <span class="op">-</span><span class="va">Ozone</span>, new <span class="op">=</span> <span class="fl">1</span>, keep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ozone Solar.R Wind new</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   -41     190  7.4   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   -36     118  8.0   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -12     149 12.6   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   -18     313 11.5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    NA      NA 14.3   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -28      NA 14.9   1</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Same holds for fcomputev</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcomputev</span><span class="op">(</span><span class="va">iris</span>, <span class="va">is.numeric</span>, <span class="va">log</span><span class="op">)</span><span class="op">)</span> <span class="co"># Same as:</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1.629241    1.252763    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1.589235    1.098612    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1.547563    1.163151    0.2623643  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1.526056    1.131402    0.4054651  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1.609438    1.280934    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1.686399    1.360977    0.5306283  -0.9162907</span>
<span class="r-in"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="select_replace_vars.html">get_vars</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="dapply.html">dapply</a></span><span class="op">(</span><span class="va">log</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1.629241    1.252763    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1.589235    1.098612    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1.547563    1.163151    0.2623643  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1.526056    1.131402    0.4054651  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1.609438    1.280934    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1.686399    1.360977    0.5306283  -0.9162907</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcomputev</span><span class="op">(</span><span class="va">iris</span>, <span class="va">is.numeric</span>, <span class="va">log</span>, keep <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span><span class="op">)</span>   <span class="co"># Adds in front</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  setosa     1.629241    1.252763    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  setosa     1.589235    1.098612    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  setosa     1.547563    1.163151    0.2623643  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  setosa     1.526056    1.131402    0.4054651  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  setosa     1.609438    1.280934    0.3364722  -1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  setosa     1.686399    1.360977    0.5306283  -0.9162907</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcomputev</span><span class="op">(</span><span class="va">iris</span>, <span class="va">is.numeric</span>, <span class="va">log</span>, keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># Preserve order</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1.629241    1.252763    0.3364722  -1.6094379  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1.589235    1.098612    0.3364722  -1.6094379  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1.547563    1.163151    0.2623643  -1.6094379  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1.526056    1.131402    0.4054651  -1.6094379  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1.609438    1.280934    0.3364722  -1.6094379  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1.686399    1.360977    0.5306283  -0.9162907  setosa</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Keep a subset of the data, add standardized columns</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fcomputev</span><span class="op">(</span><span class="va">iris</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="va">STD</span>, apply <span class="op">=</span> <span class="cn">FALSE</span>, keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Petal.Length Petal.Width Species STD.Petal.Length STD.Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1.4         0.2  setosa        -1.335752       -1.311052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1.4         0.2  setosa        -1.335752       -1.311052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1.3         0.2  setosa        -1.392399       -1.311052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1.5         0.2  setosa        -1.279104       -1.311052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1.4         0.2  setosa        -1.335752       -1.311052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1.7         0.4  setosa        -1.165809       -1.048667</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

