<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fast Indexed Time Series and Panels — indexing • collapse</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fast Indexed Time Series and Panels — indexing"><meta property="og:description" content="A fast and flexible indexed time series and panel data class that inherits from plm's 'pseries' and 'pdata.frame', but is more rigorous, natively handles irregularity, can be superimposed on any data.frame/list, matrix or vector, and supports ad-hoc computations inside data masking functions and model formulas."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.8.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://sebkrantz.github.io/Rblog/" class="external-link">Blog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/collapse_R" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast Indexed Time Series and Panels</h1>
    
    <div class="hidden name"><code>indexing.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A fast and flexible indexed time series and panel data class that inherits from <em>plm</em>'s 'pseries' and 'pdata.frame', but is more rigorous, natively handles irregularity, can be superimposed on any data.frame/list, matrix or vector, and supports ad-hoc computations inside data masking functions and model formulas.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code>## Create an 'indexed_frame' containing 'indexed_series'
findex_by(.X, ..., single = "auto", interact.ids = TRUE)
iby(.X, ..., single = "auto", interact.ids = TRUE)  # Shorthand

## Retrieve the index ('index_df') from an 'indexed_frame' or 'indexed_series'
findex(x)
ix(x)     # Shorthand

## Remove index from 'indexed_frame' or 'indexed_series' (i.e. get .X back)
unindex(x)

## Reindex 'indexed_frame' or 'indexed_series' (or index vectors / matrices)
reindex(x, index = findex(x), single = "auto")

## Check if 'indexed_frame', 'indexed_series', index or time vector is irregular
is_irregular(x, any_id = TRUE)

## Convert 'indexed_frame'/'indexed_series' to normal 'pdata.frame'/'pseries'
to_plm(x, row.names = FALSE)

# Subsetting &amp; replacement methods: [(&lt;-) methods call NextMethod().
# Also methods for fsubset, funique and roworder(v), na_omit (internal).

# S3 method for indexed_series
[(x, i, ..., drop.index.levels = "id")

# S3 method for indexed_frame
[(x, i, ..., drop.index.levels = "id")

# S3 method for indexed_frame
[(x, i, j) &lt;- value

# S3 method for indexed_frame
$(x, name)

# S3 method for indexed_frame
$(x, name) &lt;- value

# S3 method for indexed_frame
[[(x, i, ...)

# S3 method for indexed_frame
[[(x, i) &lt;- value

# Index subsetting and printing: optimized using ss()

# S3 method for index_df
[(x, i, j, drop = FALSE, drop.index.levels = "id")

# S3 method for index_df
print(x, topn = 5, ...)</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.X</dt>
<dd><p>a data frame or list-like object of equal-length columns.</p></dd>

  <dt>x</dt>
<dd><p>an 'indexed_frame' or 'indexed_series'. <code>findex</code> also works with 'pseries' and 'pdata.frame's created with <em>plm</em>. For <code>is_irregular</code> <code>x</code> can also be an index (inherits 'pindex') or a vector representing time.</p></dd>

  <dt>...</dt>
<dd><p>for <code>findex_by</code>: variables identifying the individual (id) and/or time dimensions of the data. Passed either as unquoted comma-separated column names or (tagged) expressions involving columns, or as a vector of column names, indices, a logical vector or a selector function. The time variable must enter last. See Examples. Otherwise: further arguments passed to <code><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">NextMethod()</a></code>.</p></dd>

  <dt>single</dt>
<dd><p>character. If only one indexing variable is supplied, this can be declared as <code>"id"</code> or <code>"time"</code> variable. <code>"auto"</code> chooses <code>"id"</code> if the variable has <code><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">anyDuplicated</a></code> values.</p></dd>

  <dt>interact.ids</dt>
<dd><p>logical. If <code>n &gt; 2</code> indexing variables are passed, <code>TRUE</code> calls <code><a href="qF.html">finteraction</a></code> on the first <code>n-1</code> of them (<code>n</code>'th variable must be time). <code>FALSE</code> keeps all variables in the index. The latter slows down computations of lags / differences etc. because ad-hoc interactions need to be computed, but gives more flexibility for scaling / centering / summarising over different data dimensions.</p></dd>

  <dt>index</dt>
<dd><p>and index (inherits 'pindex'), or an atomic vector or list of factors matching the data dimensions. Atomic vectors or lists with 1 factor will must be declared, see <code>single</code>. Atomic vectors will additionally be grouped / turned into time-factors. See Details.</p></dd>

  <dt>drop.index.levels</dt>
<dd><p>character. Subset methods also subset the index (= a data.frame of factors), and this argument regulates which factor levels should be dropped: either <code>"all"</code>, <code>"id"</code>, <code>"time"</code> or <code>"none"</code>. The default <code>"id"</code> only drops levels from id's. <code>"all"</code> or <code>"time"</code> should be used with caution because time-factors may contain levels for missing time periods (gaps in irregular sequences, or periods within a sequence removed through subsetting), and dropping those levels would create a variable that is ordinal but no longer represents time. The benefit of dropping levels is that it can speed-up subsequent computations by reducing the size of intermediate vectors created in C++.</p></dd>

  <dt>any_id</dt>
<dd><p>logical. For panel series: <code>FALSE</code> returns the irregularity check performed for each id, <code>TRUE</code> calls <code><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></code> on those checks.</p></dd>

  <dt>row.names</dt>
<dd><p>logical. <code>TRUE</code> creates descriptive row-names (or names for pseries) as in <code>plm</code>. This can be expensive and is usually not required for <code>plm</code> models to work.</p></dd>

  <dt>topn</dt>
<dd><p>integer. The number of first and last rows to print.</p></dd>

  <dt>i, j, name, drop, value</dt>
<dd><p>Arguments passed to <code><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">NextMethod</a></code>, or as in the <a href="https://rdrr.io/r/base/Extract.data.frame.html" class="external-link">data.frame methods</a>. Note that for index subsetting to work, <code>i</code> needs to be integer or logical (or an expression evaluation to integer or logical if <code>x</code> is a <em>data.table</em>).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The first thing to note about these new 'indexed_frame', 'indexed_series' and 'index_df' classes is that they inherit <em>plm</em>'s 'pdata.frame', 'pseries' and 'pindex' classes, respectively. Hence they are sub-classes that add, improve, and, in some cases, remove functionality provided in <em>plm</em>, with the aim of striking an optimal balance of flexibility and performance. The inheritance means that all 'pseries' and 'pdata.frame' methods in <em>collapse</em>, and also some methods in <em>plm</em>, apply to them. Where compatibility or performance considerations allow for it, <em>collapse</em> will continue to create methods for <em>plm</em>'s classes instead of the sub-classes.</p>
<p>The use of these sub-classes does not require much knowledge of <em>plm</em>, but as a basic background: A 'pdata.frame' is a data.frame with an index attribute: a data.frame of 2 factors identifying the individual and time-dimension of the data. When pulling a variable out of the pdata.frame using a method like <code>$.pdata.frame</code> or <code>[[.pdata.frame</code> (defined in <em>plm</em>), a 'pseries' is created by transferring the index attribute to the vector. Methods defined for functions like <code><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></code> / <code><a href="flag.html">flag</a></code> etc. use the index for correct computations on this panel data, also inside <em>plm</em>'s estimation commands.</p>
<p><b>Main Features and Enhancements</b></p>
<p>The 'indexed_frame' and 'indexed_series' classes extend and enhance 'pdata.frame' and 'pseries' in a number of critical dimensions. Most notably they:</p>
<ul><li><p>Support <b>both time series and panel data</b>, by allowing indexation of data with one, two or more variables.</p></li>
<li><p>Are <b>class-agnostic</b>: any data.frame/list (such as data.table, tibble, tsibble, sf etc.) can become an 'indexed_frame' and continue to function as usual for most use cases. Similarly, any vector or matrix (such as ts, mts, xts) can become an 'indexed_series'. This also allows for transient workflows e.g. <code>some_df |&gt; findex_by(...) |&gt; 'do something using collapse functions' |&gt; unindex() |&gt; 'continue working with some_df'</code>.</p></li>
<li><p>Have a comprehensive and efficient set of <b>methods for subsetting and manipulation</b>, including methods for <code><a href="fsubset.html">fsubset</a></code>, <code><a href="funique.html">funique</a></code>, <code><a href="roworder.html">roworder(v)</a></code> (internal) and <code><a href="efficient-programming.html">na_omit</a></code> (internal, <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code> also works but is slower). It is also possible to group indexed data with <code><a href="GRP.html">fgroup_by</a></code> for transformations e.g. using <code><a href="ftransform.html">fmutate</a></code>, but aggregation requires <code>unindex()</code>ing.</p></li>
<li><p><b>Natively handle irregularity</b>: time objects (such as 'Date', 'POSIXct' etc.) are passed to <code><a href="timeid.html">timeid</a></code>, which efficiently determines the temporal structure by finding the greatest common divisor (GCD), and creates a time-factor with levels corresponding to a complete time-sequence. The latter is also done with plain numeric vectors, which are assumed to represent unit time steps (GDC = 1) and coerced to integer (but can also be passed through <code><a href="timeid.html">timeid</a></code> if non-unitary). Character time variables are converted to factor, which might also capture irregular gaps in panel series. Using this time-factor in the index, <em>collapse</em>'s functions efficiently perform correct computations on irregular sequences and panels without the need to 'expand' the data / fill gaps. <code>is_irregular</code> can be used to check for irregularity in the entire sequence / panel or separately for each individual in panel data.</p></li>
<li><p>Support computations inside <b>data-masking functions and formulas</b>, by virtue of "<b>deep indexation</b>": Each variable inside an 'indexed_frame' is an 'indexed_series' which contains in its 'index_df' attribute an external pointer to the 'index_df' attribute of the frame. Functions operating on 'indexed_series' stored inside the frame (such as <code>with(data, flag(column))</code>) can fetch the index from this pointer. This allows worry-free application inside arbitrary data masking environments (<code>with</code>, <code>%$%</code>, <code>attach</code>, etc..) and estimation commands (<code>glm</code>, <code>feols</code>, <code>lmrob</code> etc..) without duplication of the index in memory. A limitation is that external pointers are only valid during the present R session, thus when saving an 'indexed_frame' and loading it again, you need to call <code>data = reindex(data)</code> before computing on it.</p></li>
</ul><p>Indexed series also have simple <a href="https://rdrr.io/r/base/groupGeneric.html" class="external-link">Math</a> and <a href="https://rdrr.io/r/base/groupGeneric.html" class="external-link">Ops</a> methods, which apply the operation to the unindexed series and shallow copy the attributes of the original object to the result, unless the result it is a logical vector (from operations like <code>!</code>, <code>==</code> etc.). For <a href="https://rdrr.io/r/base/groupGeneric.html" class="external-link">Ops</a> methods, if the LHS object is an 'indexed_series' its attributes are taken, otherwise the attributes of the RHS object are taken.</p>
<p><b>Limits to plm Compatibility</b></p>
<p>In contrast to 'pseries' and 'pdata.frame's, 'indexed_series' and 'indexed_frames' do not have descriptive "names" or "row.names" attributes attached to them, mainly for efficiency reasons.</p>
<p>Furthermore, the index is stored in an attribute named 'index_df' (same as the class name), not 'index' as in <em>plm</em>, mainly to make these classes work with <em>data.table</em>, <em>tsibble</em> and <em>xts</em>, which also utilize 'index' attributes. This for the most part poses no problem to plm compatibility because plm source code fetches the index using <code>attr(x, "index")</code>, and <code><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></code> by default performs partial matching. <!-- %It however allows plm objects to be indexed again / doubly indexed with both 'index' and 'index_df' attributes, so care needs to be taken when working with \emph{plm}. --></p>
<p>A much greater obstacle in working with <em>plm</em> is that some internal <em>plm</em> code is hinged on there being no <code>[.pseries</code> method, and the existence of <code>[.indexed_series</code> limits the use of these sub-classes in most <em>plm</em> estimation commands. Therefore the <code>to_plm</code> function is provided to efficiently coerce the sub-classes to ordinary plm objects before estimation. See Examples.</p>
<p>Overall these classes don't really benefit <em>plm</em>, especially given that collapse's plm methods also support native plm objects. However, they work very well inside other models and software, including <em>stats</em> models, <em>fixest</em> / <em>lfe</em>, and a whole bunch of time series and ML models. See Examples.</p>
<p><b>Performance Considerations</b></p>
<p>When indexing long time-series or panels with a single variable, setting <code>single = "id" or "time"</code> avoids a potentially expensive call to <code><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">anyDuplicated</a></code>. Note also that when panel-data are regular and sorted, omitting the time variable in the index can bring &gt;= 2x performance improvements in operations like lagging and differencing (alternatively use <code>shift = "row"</code> argument to <code><a href="flag.html">flag</a></code>, <code><a href="fdiff.html">fdiff</a></code> etc.) .</p>
<p>When dealing with long Date or POSIXct time sequences, it may also be that the internal processing by <code><a href="timeid.html">timeid</a></code> is slow simply because calling <code><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strftime</a></code> on these sequences to create factor levels is slow. In this case you may choose to generate an index factor with integer levels by passing <code>timeid(t)</code> to <code>findex_by</code> or <code>reindex</code> (which by default generates a 'qG' object which is internally converted to factor using <code>as_factor_qG</code>. The lazy evaluation of expressions like <code>as.character(seq_len(nlev))</code> in modern R makes this extremely efficient).</p>


<p><b>Print Method</b></p>
<p>The print methods for 'indexed_frame' and 'indexed_series' first call <code>print(unindex(x), ...)</code>, followed by the index variables with the number of categories (index factor levels) in square brackets. If the time factor contains unused levels (= irregularity in the sequence), the square brackets indicate the number of used levels (periods), followed by the total number of levels (periods in the sequence) in parentheses.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="timeid.html">timeid</a></code>,
<a href="time-series-panel-series.html">Time Series and Panel Series</a>, <a href="index.html">Collapse Overview</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Indexing panel data ----------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">wldi</span> <span class="op">&lt;-</span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">wlddev</span>, <span class="va">iso3c</span>, <span class="va">year</span><span class="op">)</span></span>
<span class="r-in"><span class="va">wldi</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date year decade     region     income  OECD PCGDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1963-01-01 1962   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 1964-01-01 1963   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 1965-01-01 1964   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   LIFEEX GINI       ODA     POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 32.446   NA 116769997 8996973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 32.962   NA 232080002 9169410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 33.471   NA 112839996 9351441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 33.971   NA 237720001 9543205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 34.463   NA 295920013 9744781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 13171 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [216] | year [61] </span>
<span class="r-in"><span class="va">wldi</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="fl">1</span><span class="op">]</span>                 <span class="co"># Works like a data frame</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [56] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] "Afghanistan" "Albania"     "Albania"     "Albania"     "Albania"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [66] "Albania"     "Albania"     "Albania"     "Albania"     "Albania"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 30 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [2] | year [61] </span>
<span class="r-in"><span class="va">POP</span> <span class="op">&lt;-</span> <span class="va">wldi</span><span class="op">$</span><span class="va">POP</span>               <span class="co"># indexed_series</span></span>
<span class="r-in"><span class="fu"><a href="qsu.html">qsu</a></span><span class="op">(</span><span class="va">POP</span><span class="op">)</span>                      <span class="co"># Summary statistics</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              N/T         Mean           SD          Min             Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall    12919  24'245971.6   102'120674         2833  1.39771500e+09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Between      216    24'178573  98'616506.7    8343.3333  1.08786967e+09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within   59.8102  24'245971.6  26'803077.4  -405'793067      510'077008</span>
<span class="r-in"><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">POP</span><span class="op">)</span>                        <span class="co"># Population growth</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]         NA  1.9166113  1.9851986  2.0506358  2.1122464  2.1707928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  2.1947467  2.2122224  2.2801797  2.4133823  2.5690449  2.7010262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  2.7517016  2.6947859  2.5104297  2.2251761  2.0011805  1.7632030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  1.2898645  0.5236261 -0.4067167 -1.3838794 -2.1952033 -2.6764778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] -2.6594766 -2.1802494 -1.6922892 -1.1217024  0.1160839  2.1593380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31]  4.5786219  7.1437882  8.9219301  9.1888632  7.9607739  6.0608254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37]  4.1013421  2.6716031  1.9664025  2.1941643  3.0197497  3.9799657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43]  4.5993546  4.7790451  4.4162776  3.7513845  3.0356420  2.5251987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49]  2.2941982  2.4259805  2.7846424  3.1930437  3.4663103  3.5563673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55]  3.4125163  3.1249152  2.8172726  2.5810946  2.4134239  2.3387468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61]         NA         NA  3.1700646  3.1039282  2.9978046  2.9225795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [67]  2.7922950  2.6695753  2.6650851  2.8832956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 13106 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"label")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Population, total"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [216] | year [61] </span>
<span class="r-in"><span class="fu"><a href="fscale.html">STD</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">POP</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>         <span class="co"># Within-standardized 1 and 10-year growth rates</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     G1         L10G1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [1,]            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [2,] -2.404379e-01            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [3,] -2.122758e-01            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [4,] -1.854071e-01            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [5,] -1.601097e-01            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [6,] -1.360704e-01            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [7,] -1.262349e-01            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [8,] -1.190593e-01            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [9,] -9.115593e-02            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [10,] -3.646264e-02            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [11,]  2.745275e-02 -2.502986e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [12,]  8.164455e-02 -2.072055e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [13,]  1.024520e-01 -1.648010e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [14,]  7.908227e-02 -1.289204e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [15,]  3.385202e-03 -1.066142e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [16,] -1.137405e-01 -1.035575e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [17,] -2.057136e-01 -1.144404e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [18,] -3.034277e-01 -1.396334e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [19,] -4.977815e-01 -1.949160e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [20,] -8.124006e-01 -2.992510e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [21,] -1.194401e+00 -4.602688e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [22,] -1.595626e+00 -6.746138e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [23,] -1.928758e+00 -9.237424e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [24,] -2.126370e+00 -1.181362e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [25,] -2.119389e+00 -1.416777e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [26,] -1.922618e+00 -1.607795e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [27,] -1.722260e+00 -1.761378e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [28,] -1.487976e+00 -1.877266e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [29,] -9.797383e-01 -1.923294e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [30,] -1.407738e-01 -1.859412e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [31,]  8.525893e-01 -1.659693e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [32,]  1.905852e+00 -1.297409e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [33,]  2.635961e+00 -7.800175e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [34,]  2.745564e+00 -1.619956e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [35,]  2.241308e+00  4.585063e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 13141 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"label")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Population, total"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "numeric" "matrix" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [216] | year [61] </span>
<span class="r-in"><span class="fu"><a href="psmat.html">psmat</a></span><span class="op">(</span><span class="va">POP</span><span class="op">)</span>                    <span class="co"># Panel-Series Matrix</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1960     1961     1962     1963     1964     1965     1966     1967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW 5.42e+04 5.54e+04 5.62e+04 5.67e+04 5.70e+04 5.74e+04 5.77e+04 5.81e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1968     1969     1970     1971     1972     1973     1974     1975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW 5.84e+04 5.87e+04 5.91e+04 5.94e+04 5.98e+04 6.02e+04 6.05e+04 6.07e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1976     1977     1978     1979     1980     1981     1982     1983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW 6.06e+04 6.04e+04 6.01e+04 6.00e+04 6.01e+04 6.06e+04 6.13e+04 6.22e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1984     1985     1986     1987     1988     1989     1990     1991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW 6.28e+04 6.30e+04 6.26e+04 6.18e+04 6.11e+04 6.10e+04 6.21e+04 6.46e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1992     1993     1994     1995     1996     1997     1998     1999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW 6.82e+04 7.25e+04 7.67e+04 8.03e+04 8.32e+04 8.55e+04 8.73e+04 8.90e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         2000     2001     2002     2003     2004     2005     2006     2007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW 9.09e+04 9.29e+04 9.50e+04 9.70e+04 9.87e+04 1.00e+05 1.01e+05 1.01e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         2008     2009     2010     2011     2012     2013     2014     2015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW 1.01e+05 1.01e+05 1.02e+05 1.02e+05 1.03e+05 1.03e+05 1.04e+05 1.04e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         2016     2017     2018     2019 2020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW 1.05e+05 1.05e+05 1.06e+05 1.06e+05   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 215 rows ]</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="psmat.html">psmat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">POP</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="indexing-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">POP</span><span class="op">[</span><span class="fl">30</span><span class="op">:</span><span class="fl">5000</span><span class="op">]</span>                  <span class="co"># Subsetting indexed_series</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 11868877 12412308 13299017 14485546 15816603 17075727 18110657 18853437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 19357126 19737765 20170844 20779953 21606988 22600770 23680871 24726684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 25654277 26433049 27100536 27722276 28394813 29185507 30117413 31161376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 32269589 33370794 34413603 35383128 36296400 37172386 38041754       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33]  1608800  1659800  1711319  1762621  1814135  1864791  1914573  1965598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41]  2022272  2081695  2135479  2187853  2243126  2296752  2350124  2404831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49]  2458526  2513546  2566266  2617832  2671997  2726056  2784278  2843960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [57]  2904429  2964762  3022635  3083605  3142336  3227943  3286542  3266790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [65]  3247039  3227287  3207536  3187784  3168033  3148281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 4901 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [82] | year [61] </span>
<span class="r-in"><span class="fu"><a href="fdiff.html">Dlog</a></span><span class="op">(</span><span class="va">POP</span><span class="op">[</span><span class="fl">30</span><span class="op">:</span><span class="fl">5000</span><span class="op">]</span><span class="op">)</span>            <span class="co"># Log-difference of subset</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]           NA  0.044768965  0.069001562  0.085461202  0.087908886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6]  0.076597770  0.058842568  0.040194682  0.026365389  0.019473185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]  0.021704390  0.029750528  0.039028057  0.044967196  0.046683615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16]  0.043215393  0.036827318  0.029904781  0.024938423  0.022682771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21]  0.023970210  0.027465763  0.031431259  0.034075870  0.034945890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]  0.033555817  0.030770836  0.027783174  0.025483466  0.023847611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31]  0.023118172           NA           NA  0.031208554  0.030567305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36]  0.029537488  0.028806864  0.027540212  0.026345639  0.026301903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41]  0.028425107  0.028960834  0.025508512  0.024229720  0.024949731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46]  0.023625522  0.022972142  0.023011538  0.022082353  0.022132522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51]  0.020757419  0.019894570  0.020479639  0.020029743  0.021132718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [56]  0.021208853  0.021039366  0.020559946  0.019332208  0.019970400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61]  0.018867105  0.026878620  0.017990856 -0.006028097 -0.006064347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [66] -0.006101658 -0.006138805 -0.006177037 -0.006215114 -0.006254301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 4901 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [82] | year [61] </span>
<span class="r-in"><span class="fu"><a href="psacf.html">psacf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identity.html" class="external-link">identity</a></span><span class="op">(</span><span class="va">POP</span><span class="op">[</span><span class="fl">30</span><span class="op">:</span><span class="fl">5000</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># ACF of subset</span></span>
<span class="r-plt img"><img src="indexing-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="flag.html">L</a></span><span class="op">(</span><span class="fu"><a href="fdiff.html">Dlog</a></span><span class="op">(</span><span class="va">POP</span><span class="op">[</span><span class="fl">30</span><span class="op">:</span><span class="fl">5000</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Multiple computations on subset</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              F1.Dlog1         Dlog1      L1.Dlog1   F1.L10Dlog1      L10Dlog1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [1,]  4.476897e-02            NA            NA            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [2,]  6.900156e-02  4.476897e-02            NA            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [3,]  8.546120e-02  6.900156e-02  4.476897e-02            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [4,]  8.790889e-02  8.546120e-02  6.900156e-02            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [5,]  7.659777e-02  8.790889e-02  8.546120e-02            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [6,]  5.884257e-02  7.659777e-02  8.790889e-02            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [7,]  4.019468e-02  5.884257e-02  7.659777e-02            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [8,]  2.636539e-02  4.019468e-02  5.884257e-02            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [9,]  1.947319e-02  2.636539e-02  4.019468e-02            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [10,]  2.170439e-02  1.947319e-02  2.636539e-02  0.5303185995            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [11,]  2.975053e-02  2.170439e-02  1.947319e-02  0.5153001629  0.5303185995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           L1.L10Dlog1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [1,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [2,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [3,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [4,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [5,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [6,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [7,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [8,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [9,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [10,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [11,]            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 4960 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "numeric" "matrix" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [82] | year [61] </span>
<span class="r-in"> </span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Fast Statistical Functions don't have dedicated methods</span></span>
<span class="r-in"><span class="co"># Thus for aggregation we need to unindex beforehand ...</span></span>
<span class="r-in"><span class="fu"><a href="fmean.html">fmean</a></span><span class="op">(</span><span class="fu">unindex</span><span class="op">(</span><span class="va">POP</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24245972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"label")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Population, total"</span>
<span class="r-in"><span class="va">wldi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">unindex</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">iso3c</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="select_replace_vars.html">num_vars</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fmean.html">fmean</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iso3c year   decade      PCGDP   LIFEEX     GINI        ODA         POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   ABW 1990 1985.574 25413.8370 72.40653       NA   33245000    76268.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   AFG 1990 1985.574   483.8351 49.19717       NA 1487548499 18362258.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   AGO 1990 1985.574  2887.6879 46.75805 48.66667  267452068 13823228.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   ALB 1990 1985.574  2819.2400 71.68027 31.41111  312928126  2708297.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   AND 1990 1985.574 40083.0911       NA       NA         NA    51547.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   ARE 1990 1985.574 64616.4864 69.37793 29.25000   13384222  3089064.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   ARG 1990 1985.574  7907.8326 71.12565 45.92258  106930833 32301197.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   ARM 1990 1985.574  2520.1808 70.67953 32.24500  282426894  2912376.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 208 rows ]</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># ... or unindex after taking group identifiers from the index</span></span>
<span class="r-in"><span class="fu"><a href="fmean.html">fmean</a></span><span class="op">(</span><span class="fu">unindex</span><span class="op">(</span><span class="fu"><a href="fgrowth.html">fgrowth</a></span><span class="op">(</span><span class="va">POP</span><span class="op">)</span><span class="op">)</span>, <span class="fu">ix</span><span class="op">(</span><span class="va">POP</span><span class="op">)</span><span class="op">$</span><span class="va">iso3c</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ABW         AFG         AGO         ALB         AND         ARE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.15986116  2.50218519  3.04019111  0.98728941  3.03828499  8.33912222 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ARG         ARM         ASM         ATG         AUS         AUT </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.34100846  0.78894579  1.74127860  0.99964449  1.54424580  0.39301937 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         AZE         BDI         BEL         BEN         BFA         BGD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.61742943  2.43172184  0.38832202  2.71473569  2.46698310  2.09594336 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         BGR         BHR         BHS         BIH         BLR         BLZ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.20095889  4.01156764  2.17972600  0.04870005  0.23697183  2.48033866 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         BMU         BOL         BRA         BRB         BRN         BTN </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.62656641  1.96310764  1.83756339  0.36894714  2.87598784  2.10961311 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         BWA         CAF         CAN         CHE         CHI         CHL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.61689824  1.97141241  1.26547829  0.81130910  0.77252949  1.44461721 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CHN         CIV         CMR         COD         COG         COL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.26475057  3.43990856  2.76520875  2.99210471  2.86194380  1.95730439 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         COM         CPV         CRI         CUB         CUW         CYM </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.56471792  1.71779560  2.28825488  0.78844375  0.40380104  3.65940831 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CYP         CZE         DEU         DJI         DMA         DNK </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.26066375  0.17964024  0.22511110  4.28964392  0.30770228  0.40573747 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DOM         DZA         ECU         EGY         ERI         ESP </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.02552207  2.33239690  2.30053844  2.27489144  2.30900292  0.74430651 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         EST         ETH         FIN         FJI         FRA         FRO </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.15848536  2.78733512  0.37433864  1.39760426  0.61832292  0.58122004 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         FSM         GAB         GBR         GEO </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.61438473  2.51981406  0.41364183  0.04208078 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 146 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"label")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Population, total"</span>
<span class="r-in"><span class="va">wldi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="select_replace_vars.html">num_vars</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span>iso3c <span class="op">=</span> <span class="fu">ix</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">$</span><span class="va">iso3c</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">unindex</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fmean.html">fmean</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iso3c year   decade      PCGDP   LIFEEX     GINI        ODA         POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   ABW 1990 1985.574 25413.8370 72.40653       NA   33245000    76268.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   AFG 1990 1985.574   483.8351 49.19717       NA 1487548499 18362258.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   AGO 1990 1985.574  2887.6879 46.75805 48.66667  267452068 13823228.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   ALB 1990 1985.574  2819.2400 71.68027 31.41111  312928126  2708297.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   AND 1990 1985.574 40083.0911       NA       NA         NA    51547.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   ARE 1990 1985.574 64616.4864 69.37793 29.25000   13384222  3089064.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   ARG 1990 1985.574  7907.8326 71.12565 45.92258  106930833 32301197.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   ARM 1990 1985.574  2520.1808 70.67953 32.24500  282426894  2912376.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 208 rows ]</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># With matrix methods it is easier as most attributes are dropped upon aggregation.</span></span>
<span class="r-in"><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">POP</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fmean.html">fmean</a></span><span class="op">(</span><span class="fu">ix</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">$</span><span class="va">iso3c</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              G1       L10G1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABW  1.15986116  13.5405797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AFG  2.50218519  29.7453631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGO  3.04019111  37.2423846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALB  0.98728941  10.4611010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AND  3.03828499  36.8630696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARE  8.33912222 145.2957118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARG  1.34100846  14.3289740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARM  0.78894579   7.1746628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASM  1.74127860  20.2992819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ATG  0.99964449  10.0195522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AUS  1.54424580  16.0434792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AUT  0.39301937   3.5211125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AZE  1.61742943  16.4526447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BDI  2.43172184  26.7915415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BEL  0.38832202   3.6354631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BEN  2.71473569  31.9252634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BFA  2.46698310  28.3385127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BGD  2.09594336  23.3556445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BGR -0.20095889  -2.3160917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BHR  4.01156764  50.7327853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BHS  2.17972600  22.6999691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIH  0.04870005   0.5070281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BLR  0.23697183   2.1725510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BLZ  2.48033866  27.8347280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BMU  0.62656641   5.7036637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BOL  1.96310764  21.9315509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BRA  1.83756339  20.1289837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BRB  0.36894714   3.9565564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BRN  2.87598784  33.4451942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BTN  2.10961311  23.9024113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BWA  2.61689824  31.1856395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CAF  1.97141241  22.7889510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CAN  1.26547829  12.8834454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CHE  0.81130910   7.3670756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CHI  0.77252949   7.6461689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 181 rows ]</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example of index with multiple ids</span></span>
<span class="r-in"><span class="va">GGDC10S</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">Variable</span>, <span class="va">Country</span>, <span class="va">Year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># default is interact.ids = TRUE</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Country Regioncode             Region Variable Year AGR MIN MAN PU CON WRT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     BWA        SSA Sub-saharan Africa       VA 1960  NA  NA  NA NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     BWA        SSA Sub-saharan Africa       VA 1961  NA  NA  NA NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     BWA        SSA Sub-saharan Africa       VA 1962  NA  NA  NA NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     BWA        SSA Sub-saharan Africa       VA 1963  NA  NA  NA NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TRA FIRE GOV OTH SUM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  NA   NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  NA   NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  NA   NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  NA   NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 2 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  Variable.Country [1] | Year [6 (67)] </span>
<span class="r-in"><span class="va">GGDCi</span> <span class="op">&lt;-</span> <span class="va">GGDC10S</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">Variable</span>, <span class="va">Country</span>, <span class="va">Year</span>, interact.ids <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">GGDCi</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Country Regioncode             Region Variable Year AGR MIN MAN PU CON WRT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     BWA        SSA Sub-saharan Africa       VA 1960  NA  NA  NA NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     BWA        SSA Sub-saharan Africa       VA 1961  NA  NA  NA NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     BWA        SSA Sub-saharan Africa       VA 1962  NA  NA  NA NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     BWA        SSA Sub-saharan Africa       VA 1963  NA  NA  NA NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TRA FIRE GOV OTH SUM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  NA   NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  NA   NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  NA   NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  NA   NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 2 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  Variable [1] Country [1] | Year [6 (67)] </span>
<span class="r-in"><span class="fu">findex</span><span class="op">(</span><span class="va">GGDCi</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Variable Country Year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       VA     BWA 1960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       VA     BWA 1961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       VA     BWA 1962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       VA     BWA 1963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       VA     BWA 1964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5023 EMP EGY 2008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5024 EMP EGY 2009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5025 EMP EGY 2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5026 EMP EGY 2011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5027 EMP EGY 2012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variable [2] Country [43] | Year [67]</span>
<span class="r-in"><span class="co"># The benefit is increased flexibility for summary statistics and data transformation</span></span>
<span class="r-in"><span class="fu"><a href="qsu.html">qsu</a></span><span class="op">(</span><span class="va">GGDCi</span>, effect <span class="op">=</span> <span class="st">"Country"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Country</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              N/T  Mean  SD  Min  Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall     5027     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Between       43     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within   116.907     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Regioncode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              N/T  Mean  SD  Min  Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall     5027     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Between       43     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within   116.907     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              N/T  Mean  SD  Min  Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall     5027     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Between       43     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within   116.907     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              N/T  Mean  SD  Min  Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall     5027     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Between       43     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within   116.907     -   -    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , Year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              N/T       Mean       SD        Min        Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall     5027  1981.5801  17.5704       1947       2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Between       43  1982.4236   5.0799  1978.7519     2011.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 1 row(s) and 11 matrix slice(s) ]</span>
<span class="r-in"><span class="fu"><a href="fscale.html">STD</a></span><span class="op">(</span><span class="va">GGDCi</span><span class="op">$</span><span class="va">SUM</span>, effect <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span>            <span class="co"># Standardizing by variable</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]         NA         NA         NA         NA -0.1226776 -0.1226776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -0.1226776 -0.1226776 -0.1226776 -0.1226776 -0.1226775 -0.1226775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] -0.1226774 -0.1226773 -0.1226772 -0.1226771 -0.1226769 -0.1226767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] -0.1226766 -0.1226762 -0.1226756 -0.1226753 -0.1226752 -0.1226744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] -0.1226738 -0.1226724 -0.1226704 -0.1226692 -0.1226661 -0.1226627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] -0.1226607 -0.1226582 -0.1226567 -0.1226550 -0.1226499 -0.1226448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] -0.1226376 -0.1226320 -0.1226275 -0.1226148 -0.1226044 -0.1225979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] -0.1225908 -0.1225861 -0.1225770 -0.1225543 -0.1225338 -0.1225158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] -0.1224963 -0.1225084 -0.1224488         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55]         NA         NA -0.3807465 -0.3806958 -0.3806859 -0.3806942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] -0.3806630 -0.3805993 -0.3805239 -0.3804590 -0.3803244 -0.3802321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [67] -0.3801543 -0.3800409 -0.3799774 -0.3799017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 4957 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"label")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Summation of sector GDP"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"format.stata")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "%10.0g"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  Variable [2] Country [43] | Year [67] </span>
<span class="r-in"><span class="fu"><a href="fscale.html">STD</a></span><span class="op">(</span><span class="va">GGDCi</span><span class="op">$</span><span class="va">SUM</span>, effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Variable"</span>, <span class="st">"Year"</span><span class="op">)</span><span class="op">)</span> <span class="co"># ... by variable and year</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]         NA         NA         NA         NA -0.2041456 -0.2039970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -0.2023122 -0.2041736 -0.2058182 -0.2068329 -0.1799561 -0.1784717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] -0.1794400 -0.1809847 -0.1852166 -0.1881118 -0.1915147 -0.1952319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] -0.2000250 -0.2086539 -0.2176069 -0.2246298 -0.2285386 -0.2384116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] -0.2442721 -0.2480965 -0.2533789 -0.2618757 -0.2684392 -0.2739245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] -0.2788689 -0.2831778 -0.2934982 -0.3006316 -0.3052873 -0.3081273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] -0.3074253 -0.3039395 -0.2818521 -0.2751017 -0.2694049 -0.2606845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] -0.2576762 -0.2567207 -0.2531264 -0.2434613 -0.2351500 -0.2288238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] -0.2182615 -0.2127535 -0.2090734         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55]         NA         NA -0.4596772 -0.4497862 -0.4399738 -0.4363115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] -0.4331453 -0.4247106 -0.4027655 -0.4096142 -0.4114065 -0.4141980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [67] -0.4082425 -0.4024895 -0.4026850 -0.4047382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 4957 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"label")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Summation of sector GDP"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"format.stata")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "%10.0g"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  Variable [2] Country [43] | Year [67] </span>
<span class="r-in"><span class="co"># But time-based operations are a bit more expensive because of the necessary interactions</span></span>
<span class="r-in"><span class="fu"><a href="fdiff.html">D</a></span><span class="op">(</span><span class="va">GGDCi</span><span class="op">$</span><span class="va">SUM</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]            NA            NA            NA            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6]     1.8648058     3.7996670    -1.7515810    -0.2525958    10.0790095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]    15.2179271    12.1300779    31.7872318    37.4213552    35.1940244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16]    36.8116252    85.0015379    44.7177833    52.5841475   158.9853717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21]   198.2115288   103.9129599    23.7520357   288.7796000   214.2149426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]   515.3786450   726.9937149   439.7886989  1085.0704934  1220.4747092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31]   737.8868699   879.8964485   529.0696305   617.1251820  1841.1712884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36]  1803.6482296  2600.8383913  1986.0421431  1631.5058344  4552.4978100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41]  3712.3024701  2342.9411903  2519.9965561  1715.6370519  3237.7063677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46]  8127.4111125  7374.8681409  6430.3096108  6983.2264598 -4322.3684709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51] 21358.0356275            NA            NA            NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [56]            NA            NA     4.8807941     0.9545929    -0.8001645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61]     3.0111420     6.1276582     7.2716726     6.2475417    12.9682512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [66]     8.8843341     7.4951964    10.9173822     6.1179949     7.2972389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 4957 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"label")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Summation of sector GDP"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"format.stata")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "%10.0g"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  Variable [2] Country [43] | Year [67] </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Panel-Data modelling ---------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Linear model of 5-year annualized growth rates of GDP on Life Expactancy + 5y lag</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">PCGDP</span>, <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="flag.html">L</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">LIFEEX</span>, <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="va">wldi</span><span class="op">)</span> <span class="co"># p abbreviates "power"</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = G(PCGDP, 5, p = 1/5) ~ L(G(LIFEEX, 5, p = 1/5), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     c(0, 5)), data = wldi)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         (Intercept)  L(G(LIFEEX, 5, p = 1/5), c(0, 5))--  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              1.6021                               0.4739  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(G(LIFEEX, 5, p = 1/5), c(0, 5))L5  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              0.1716  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Same, adding time fixed effects via plm package: need to utilize to_plm function</span></span>
<span class="r-in"><span class="fu">plm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html" class="external-link">plm</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">PCGDP</span>, <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="flag.html">L</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">LIFEEX</span>, <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="fu">to_plm</span><span class="op">(</span><span class="va">wldi</span><span class="op">)</span>, effect <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Formula: G(PCGDP, 5, p = 1/5) ~ L(G(LIFEEX, 5, p = 1/5), c(0, 5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x106fc9850&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(G(LIFEEX, 5, p = 1/5), c(0, 5))-- L(G(LIFEEX, 5, p = 1/5), c(0, 5))L5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             0.26902                             0.34879 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># With country and time fixed effects via fixest</span></span>
<span class="r-in"><span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">PCGDP</span>, <span class="fl">5</span>, p<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="flag.html">L</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">LIFEEX</span>, <span class="fl">5</span>, p<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="va">wldi</span>, fixef <span class="op">=</span> <span class="fu"><a href="small-helpers.html">.c</a></span><span class="op">(</span><span class="va">iso3c</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: 5,596 observations removed because of NA values (LHS: 4,720, RHS: 3,522).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OLS estimation, Dep. Var.: G(PCGDP, 5, p = 1/5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observations: 7,580 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed-effects: iso3c: 192,  year: 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard-errors: Clustered (iso3c) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     Estimate Std. Error t value   Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(G(LIFEEX, 5, p = 1/5), c(0, 5))-- 0.392178   0.104398 3.75657 2.2867e-04 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L(G(LIFEEX, 5, p = 1/5), c(0, 5))L5 0.476969   0.112195 4.25125 3.3228e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 3.05102     Adj. R2: 0.279618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Within R2: 0.019289</span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Running a robust MM regression without fixed effects</span></span>
<span class="r-in"><span class="fu">robustbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/lmrob.html" class="external-link">lmrob</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">PCGDP</span>, <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="flag.html">L</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">LIFEEX</span>, <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="va">wldi</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Running a robust MM regression with country and time fixed effects</span></span>
<span class="r-in"><span class="va">wldi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="select_replace_vars.html">fselect</a></span><span class="op">(</span><span class="va">PCGDP</span>, <span class="va">LIFEEX</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="fgrowth.html">fgrowth</a></span><span class="op">(</span><span class="fl">5</span>, power <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="ftransform.html">ftransform</a></span><span class="op">(</span>LIFEEX_L5 <span class="op">=</span> <span class="fu"><a href="flag.html">L</a></span><span class="op">(</span><span class="va">LIFEEX</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="co"># drop abbreviates drop.index.levels (not strictly needed here but more consistent)</span></span>
<span class="r-in">  <span class="fu"><a href="efficient-programming.html">na_omit</a></span><span class="op">(</span>drop <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fhdbetween_fhdwithin.html">fhdwithin</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># For TFE use fwithin(effect = "year")</span></span>
<span class="r-in">  <span class="fu">unindex</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">robustbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/lmrob.html" class="external-link">lmrob</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">PCGDP</span> <span class="op">~</span><span class="va">.</span><span class="op">)</span>    <span class="co"># using lm() gives same result as fixest</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Using a random forest model without fixed effects</span></span>
<span class="r-in"><span class="co"># ranger does not support these kinds of formulas, thus we need some preprocessing...</span></span>
<span class="r-in"><span class="va">wldi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="select_replace_vars.html">fselect</a></span><span class="op">(</span><span class="va">PCGDP</span>, <span class="va">LIFEEX</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="fgrowth.html">fgrowth</a></span><span class="op">(</span><span class="fl">5</span>, power <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="ftransform.html">ftransform</a></span><span class="op">(</span>LIFEEX_L5 <span class="op">=</span> <span class="fu"><a href="flag.html">L</a></span><span class="op">(</span><span class="va">LIFEEX</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">unindex</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="efficient-programming.html">na_omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ranger</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html" class="external-link">ranger</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">PCGDP</span> <span class="op">~</span><span class="va">.</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Indexing other data frame based classes --------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">wlditbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="quick-conversion.html">qTBL</a></span><span class="op">(</span><span class="va">wlddev</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">iso3c</span>, <span class="va">year</span><span class="op">)</span></span>
<span class="r-in"><span class="va">wlditbl</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># Works like a tibble...</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 13,176 × 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    iso3c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AFG  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 13,166 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [216] | year [61] </span>
<span class="r-in"><span class="va">wlditbl</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG AFG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58] AFG AFG AFG AFG ALB ALB ALB ALB ALB ALB ALB ALB ALB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 13106 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"label")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Country Code</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 216 Levels: ABW AFG AGO ALB AND ARE ARG ARM ASM ATG AUS AUT AZE BDI BEL ... ZWE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [216] | year [61] </span>
<span class="r-in"><span class="va">wlditbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="fl">10</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 × 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>   32.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>   33.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>   33.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>   34.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>   34.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>   34.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>   35.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>   35.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>   36.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>   36.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 990 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [17] | year [61] </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">wlditbl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   country   iso3c date        year decade region income OECD  PCGDP LIFEEX  GINI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Afghanis… AFG   1961-01-01  <span style="text-decoration: underline;">1</span>960   <span style="text-decoration: underline;">1</span>960 South… Low i… FALSE    <span style="color: #BB0000;">NA</span>   32.4    <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Afghanis… AFG   1962-01-01  <span style="text-decoration: underline;">1</span>961   <span style="text-decoration: underline;">1</span>960 South… Low i… FALSE    <span style="color: #BB0000;">NA</span>   33.0    <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Afghanis… AFG   1963-01-01  <span style="text-decoration: underline;">1</span>962   <span style="text-decoration: underline;">1</span>960 South… Low i… FALSE    <span style="color: #BB0000;">NA</span>   33.5    <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Afghanis… AFG   1964-01-01  <span style="text-decoration: underline;">1</span>963   <span style="text-decoration: underline;">1</span>960 South… Low i… FALSE    <span style="color: #BB0000;">NA</span>   34.0    <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> Afghanis… AFG   1965-01-01  <span style="text-decoration: underline;">1</span>964   <span style="text-decoration: underline;">1</span>960 South… Low i… FALSE    <span style="color: #BB0000;">NA</span>   34.5    <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> Afghanis… AFG   1966-01-01  <span style="text-decoration: underline;">1</span>965   <span style="text-decoration: underline;">1</span>960 South… Low i… FALSE    <span style="color: #BB0000;">NA</span>   34.9    <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 2 more variables: ODA &lt;dbl&gt;, POP &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [1] | year [6 (61)] </span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">wldidt</span> <span class="op">&lt;-</span> <span class="fu"><a href="quick-conversion.html">qDT</a></span><span class="op">(</span><span class="va">wlddev</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">iso3c</span>, <span class="va">year</span><span class="op">)</span></span>
<span class="r-in"><span class="va">wldidt</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span>      <span class="co"># Works like a data.table...</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           country iso3c       date year decade                    region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: Afghanistan   AFG 1961-01-01 1960   1960                South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: Afghanistan   AFG 1962-01-01 1961   1960                South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: Afghanistan   AFG 1963-01-01 1962   1960                South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: Afghanistan   AFG 1964-01-01 1963   1960                South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: Afghanistan   AFG 1965-01-01 1964   1960                South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            income  OECD    PCGDP LIFEEX GINI       ODA     POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:  Low income FALSE       NA 32.446   NA 116769997 8996973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:  Low income FALSE       NA 32.962   NA 232080002 9169410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:  Low income FALSE       NA 33.471   NA 112839996 9351441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:  Low income FALSE       NA 33.971   NA 237720001 9543205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:  Low income FALSE       NA 34.463   NA 295920013 9744781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 6 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [17] | year [61] </span>
<span class="r-in"><span class="va">wldidt</span><span class="op">[</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">2000</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           country iso3c       date year decade             region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: Afghanistan   AFG 2002-01-01 2001   2000         South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: Afghanistan   AFG 2003-01-01 2002   2000         South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: Afghanistan   AFG 2004-01-01 2003   2000         South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: Afghanistan   AFG 2005-01-01 2004   2000         South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: Afghanistan   AFG 2006-01-01 2005   2000         South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    income  OECD     PCGDP LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:          Low income FALSE        NA 56.308   NA  682969971 21606988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:          Low income FALSE  330.3036 56.784   NA 1790479980 22600770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:          Low income FALSE  343.0809 57.271   NA 1972890015 23680871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:          Low income FALSE  333.2167 57.772   NA 2681449951 24726684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:          Low income FALSE  357.2347 58.290   NA 3306389893 25654277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 6 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  iso3c [216] | year [20 (61)] </span>
<span class="r-in"><span class="va">wldidt</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>sum_PCGDP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">PCGDP</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">country</span><span class="op">]</span> <span class="co"># Aggregation unindexes the result</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    country   sum_PCGDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:           Afghanistan    8709.031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:               Albania  112769.600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:               Algeria  211936.285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:        American Samoa  171208.120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:               Andorra 2004154.553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 212: Virgin Islands (U.S.)  570075.738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 213:    West Bank and Gaza   62099.304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 214:           Yemen, Rep.   32089.789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 215:                Zambia   79131.760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 216:              Zimbabwe   73166.158</span>
<span class="r-in"><span class="va">wldidt</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">sum</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">country</span>, .SDcols <span class="op">=</span> <span class="fu"><a href="small-helpers.html">.c</a></span><span class="op">(</span><span class="va">PCGDP</span>, <span class="va">LIFEEX</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    country       PCGDP   LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:           Afghanistan    8709.031 2951.830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:               Albania  112769.600 4300.816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:               Algeria  211936.285 3813.774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:        American Samoa  171208.120    0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:               Andorra 2004154.553    0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 212: Virgin Islands (U.S.)  570075.738 4422.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 213:    West Bank and Gaza   62099.304 2148.234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 214:           Yemen, Rep.   32089.789 3152.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 215:                Zambia   79131.760 3065.558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 216:              Zimbabwe   73166.158 3272.016</span>
<span class="r-in"><span class="co"># This also works but is a bit inefficient since the index is subset and then dropped</span></span>
<span class="r-in"><span class="co"># -&gt; better unindex beforehand</span></span>
<span class="r-in"><span class="va">wldidt</span><span class="op">[</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">2000</span>, <span class="fu">.</span><span class="op">(</span>sum_PCGDP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">PCGDP</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">country</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    country  sum_PCGDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:           Afghanistan   8709.031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:               Albania  73832.383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:               Algeria  84017.769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:        American Samoa 171208.120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:               Andorra 827219.533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 212: Virgin Islands (U.S.) 570075.738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 213:    West Bank and Gaza  47661.621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 214:           Yemen, Rep.  20313.628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 215:                Zambia  26490.196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 216:              Zimbabwe  21161.694</span>
<span class="r-in"><span class="va">wldidt</span><span class="op">[</span>, <span class="va">PCGDP_gr_5Y</span> <span class="op">:=</span> <span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">PCGDP</span>, <span class="fl">5</span>, power <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>  <span class="co"># Can add Variables by reference</span></span>
<span class="r-in"><span class="co"># Note that .SD is a data.table of indexed_series, not an indexed_frame, so this is WRONG!</span></span>
<span class="r-in"><span class="va">wldidt</span><span class="op">[</span>, <span class="fu"><a href="small-helpers.html">.c</a></span><span class="op">(</span><span class="va">PCGDP_gr_5Y</span>, <span class="va">LIFEEX_gr_5Y</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">slt</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">PCGDP</span>, <span class="va">LIFEEX</span><span class="op">)</span>, <span class="fl">5</span>, power <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Found '.SD' in the call but no 'apply' function. Please note that .SD is not an indexed_frame but a plain data.table containing indexed_series. Thus indexed_frame / pdata.frame methods don't work on .SD! Consider using (m/l)apply(.SD, FUN) or reindex(.SD, ix(data)). If you are not performing indexed operations on .SD please ignore or suppress this warning.</span>
<span class="r-in"><span class="co"># This gives the correct outcome</span></span>
<span class="r-in"><span class="va">wldidt</span><span class="op">[</span>, <span class="fu"><a href="small-helpers.html">.c</a></span><span class="op">(</span><span class="va">PCGDP_gr_5Y</span>, <span class="va">LIFEEX_gr_5Y</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">slt</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">PCGDP</span>, <span class="va">LIFEEX</span><span class="op">)</span>, <span class="va">G</span>, <span class="fl">5</span>, power <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shape/nc.shp"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">nci</span> <span class="op">&lt;-</span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">nc</span>, <span class="va">SID74</span><span class="op">)</span></span>
<span class="r-in"><span class="va">nci</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="st">"AREA"</span><span class="op">]</span></span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">nci</span><span class="op">)</span> <span class="co"># The geometry column is never indexed, thus sf computations work normally</span></span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">nci</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="fmean.html">fmean</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">nci</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tsibble.tidyverts.org" class="external-link">tsibble</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">pedi</span> <span class="op">&lt;-</span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">pedestrian</span>, <span class="va">Sensor</span>, <span class="va">Date_Time</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pedi</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span>
<span class="r-in"><span class="fu">findex</span><span class="op">(</span><span class="va">pedi</span><span class="op">)</span> <span class="co"># Time factor with 17k levels from POSIXct</span></span>
<span class="r-in"><span class="co"># Now here is a case where integer levels in the index can really speed things up</span></span>
<span class="r-in"><span class="fu">ix</span><span class="op">(</span><span class="fu">iby</span><span class="op">(</span><span class="va">pedestrian</span>, <span class="va">Sensor</span>, <span class="fu"><a href="timeid.html">timeid</a></span><span class="op">(</span><span class="va">Date_Time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>descriptive_levels <span class="op">=</span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">pedestrian</span>, <span class="va">Sensor</span>, <span class="va">Date_Time</span><span class="op">)</span>,</span>
<span class="r-in">               integer_levels <span class="op">=</span> <span class="fu">findex_by</span><span class="op">(</span><span class="va">pedestrian</span>, <span class="va">Sensor</span>, <span class="fu"><a href="timeid.html">timeid</a></span><span class="op">(</span><span class="va">Date_Time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Data has irregularity</span></span>
<span class="r-in"><span class="fu">is_irregular</span><span class="op">(</span><span class="va">pedi</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">is_irregular</span><span class="op">(</span><span class="va">pedi</span>, any_id <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># irregularity in all sequences</span></span>
<span class="r-in"><span class="co"># Manipulation such as lagging with tsibble/dplyr requires expanding rows and grouping</span></span>
<span class="r-in"><span class="co"># Collapse can just compute correct lag on indexed series or frames</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span class="r-in">  dplyr <span class="op">=</span> <span class="fu"><a href="https://tsibble.tidyverts.org/reference/fill_gaps.html" class="external-link">fill_gaps</a></span><span class="op">(</span><span class="va">pedestrian</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tsibble.tidyverts.org/reference/group_by_key.html" class="external-link">group_by_key</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Lag_Count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  collapse <span class="op">=</span> <span class="fu"><a href="ftransform.html">fmutate</a></span><span class="op">(</span><span class="va">pedi</span>, Lag_Count <span class="op">=</span> <span class="fu"><a href="flag.html">flag</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Indexing Atomic objects ---------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ts</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1949 112 118 132 129 121 135 148 148 136 119 104 118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1950 115 126 141 135 125 149 170 170 158 133 114 140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1951 145 150 178 163 172 178 199 199 184 162 146 166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1952 171 180 193 181 183 218 230 242 209 191 172 194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1953 196 196 236 235 229 243 264 272 237 211 180 201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 7 rows ]</span>
<span class="r-in"><span class="va">AirPassengers</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">]</span>        <span class="co"># Ts class does not support irregularity, subsetting drops class</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 112 118 132 129 121 135 148 148 136 119 104 118 115 126 141 135 125 149 170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] 199 199 184 162 146 166 171 180 193 181 183 218 230 242 209 191 172 194 196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] 196 236 235 229 243 264 272 237 211 180 201 204 188 235 227 234 264 302 293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58] 259 229 203 229 242 233 267 269 270 315 364 347 312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 63 entries ]</span>
<span class="r-in"><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">]</span>, <span class="fl">12</span><span class="op">)</span> <span class="co"># Annual Growth Rate: Wrong!</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]         NA         NA         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]         NA         NA         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  2.6785714  6.7796610  6.8181818  4.6511628  3.3057851 10.3703704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] 14.8648649 34.4594595 46.3235294 54.6218487 55.7692308 23.7288136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 44.3478261 35.7142857 27.6595745 42.9629630 44.8000000 22.8187919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 28.2352941 15.5778894 21.6080402 13.5869565 17.9012346 17.8082192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] 16.8674699 14.6198830  8.8888889 22.2797927 29.8342541 25.1366120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] 11.4678899 14.7826087 12.3966942 13.3971292 10.4712042  4.6511628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49]  3.6082474  4.0816327 -4.0816327 -0.4237288 -3.4042553  2.1834061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55]  8.6419753 14.3939394  7.7205882  9.2827004  8.5308057 12.7777778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] 13.9303483 18.6274510 23.9361702 13.6170213 18.5022026 15.3846154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [67] 19.3181818 20.5298013 18.4300341 20.4633205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 63 entries ]</span>
<span class="r-in"><span class="co"># Now indexing AirPassengers (identity() is a trick so that the index is named time(AirPassengers))</span></span>
<span class="r-in"><span class="va">iAP</span> <span class="op">&lt;-</span> <span class="fu">reindex</span><span class="op">(</span><span class="va">AirPassengers</span>, <span class="fu"><a href="https://rdrr.io/r/base/identity.html" class="external-link">identity</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">iAP</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1949 112 118 132 129 121 135 148 148 136 119 104 118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1950 115 126 141 135 125 149 170 170 158 133 114 140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1951 145 150 178 163 172 178 199 199 184 162 146 166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1952 171 180 193 181 183 218 230 242 209 191 172 194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1953 196 196 236 235 229 243 264 272 237 211 180 201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 7 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  time(AirPassengers) [144] </span>
<span class="r-in"><span class="fu">findex</span><span class="op">(</span><span class="va">iAP</span><span class="op">)</span>    <span class="co"># See the index</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time(AirPassengers)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                1949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         1949.083333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         1949.166666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         1949.249999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         1949.333332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140 1960.583287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141  1960.66662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142 1960.749953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143 1960.833286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144 1960.916619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time(AirPassengers) [144]</span>
<span class="r-in"><span class="va">iAP</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">]</span>  <span class="co"># Subsetting</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 112 118 132 129 121 135 148 148 136 119 104 118 115 126 141 135 125 149 170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] 199 199 184 162 146 166 171 180 193 181 183 218 230 242 209 191 172 194 196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] 196 236 235 229 243 264 272 237 211 180 201 204 188 235 227 234 264 302 293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58] 259 229 203 229 242 233 267 269 270 315 364 347 312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 63 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  time(AirPassengers) [133 (144)] </span>
<span class="r-in"><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">iAP</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">]</span>, <span class="fl">12</span><span class="op">)</span>                <span class="co"># Annual Growth Rate: Correct!</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]         NA         NA         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]         NA         NA         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  2.6785714  6.7796610  6.8181818  4.6511628  3.3057851 10.3703704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] 14.8648649 17.0588235         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]         NA         NA         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31]         NA 15.5778894 21.6080402 13.5869565 17.9012346 17.8082192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] 16.8674699 14.6198830  8.8888889 22.2797927 29.8342541 25.1366120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] 11.4678899 14.7826087 12.3966942 13.3971292 10.4712042  4.6511628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49]  3.6082474  4.0816327 -4.0816327 -0.4237288 -3.4042553  2.1834061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55]  8.6419753 14.3939394  7.7205882  9.2827004  8.5308057 12.7777778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] 13.9303483 18.6274510 23.9361702 13.6170213 18.5022026 15.3846154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [67] 19.3181818 20.5298013 18.4300341 20.4633205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 63 entries ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  time(AirPassengers) [133 (144)] </span>
<span class="r-in"><span class="fu"><a href="flag.html">L</a></span><span class="op">(</span><span class="fu"><a href="fgrowth.html">G</a></span><span class="op">(</span><span class="va">iAP</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Lagged level, period and annual growth rates...</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         -- L1.--          G1       L1.G1      L12G1   L1.L12G1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1,] 112    NA          NA          NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2,] 118   112   5.3571429          NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3,] 132   118  11.8644068   5.3571429         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4,] 129   132  -2.2727273  11.8644068         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5,] 121   129  -6.2015504  -2.2727273         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [6,] 135   121  11.5702479  -6.2015504         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7,] 148   135   9.6296296  11.5702479         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [8,] 148   148   0.0000000   9.6296296         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [9,] 136   148  -8.1081081   0.0000000         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [10,] 119   136 -12.5000000  -8.1081081         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [11,] 104   119 -12.6050420 -12.5000000         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 122 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "numeric" "matrix" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  time(AirPassengers) [133 (144)] </span>
<span class="r-in"> </span>
<span class="r-in"><span class="co">## xts</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/xts" class="external-link">xts</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zoo.R-Forge.R-project.org/" class="external-link">zoo</a></span><span class="op">)</span> <span class="co"># Needed for as.yearmon() and index() functions</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">wlddev</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fsubset.html">fsubset</a></span><span class="op">(</span><span class="va">iso3c</span> <span class="op">==</span> <span class="st">"DEU"</span>, <span class="va">date</span>, <span class="va">PCGDP</span><span class="op">:</span><span class="va">POP</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/xts/man/xts.html" class="external-link">xts</a></span><span class="op">(</span><span class="fu"><a href="select_replace_vars.html">num_vars</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, order.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.yearmon</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fsubset.html">ss</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">30</span><span class="op">:</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">reindex</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identity.html" class="external-link">identity</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/index.html" class="external-link">index</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># Introducing a gap</span></span>
<span class="r-in"><span class="co"># plot(G(unindex(X)))</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/plm/man/lag.plm.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu">unindex</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>    <span class="co"># diff.xts gixes wrong result</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                PCGDP       LIFEEX GINI ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1961          NA           NA   NA  NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1962          NA  0.197975610   NA  NA   562732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1963          NA  0.183536585   NA  NA   648152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1964          NA  0.168073171   NA  NA   688569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1965          NA  0.154097561   NA  NA   603984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1966          NA  0.138121951   NA  NA   645358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1967          NA  0.119585366   NA  NA   636616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1968          NA  0.102585366   NA  NA   351025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1969          NA  0.091097561   NA  NA   342978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1970          NA  0.085585366   NA  NA   615368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1971          NA  0.089097561   NA  NA   259607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1972   579.34931  0.103097561   NA  NA   143553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1973   770.40722  0.124121951   NA  NA   375610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1974   935.46605  0.149682927   NA  NA   248214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 36 rows ]</span>
<span class="r-in"><span class="fu"><a href="fdiff.html">fdiff</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>            <span class="co"># fdiff gives right result</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                PCGDP       LIFEEX GINI ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1961          NA           NA   NA  NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1962          NA  0.197975610   NA  NA   562732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1963          NA  0.183536585   NA  NA   648152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1964          NA  0.168073171   NA  NA   688569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1965          NA  0.154097561   NA  NA   603984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1966          NA  0.138121951   NA  NA   645358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1967          NA  0.119585366   NA  NA   636616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1968          NA  0.102585366   NA  NA   351025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1969          NA  0.091097561   NA  NA   342978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1970          NA  0.085585366   NA  NA   615368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1971          NA  0.089097561   NA  NA   259607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1972   579.34931  0.103097561   NA  NA   143553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1973   770.40722  0.124121951   NA  NA   375610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1974   935.46605  0.149682927   NA  NA   248214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 36 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Indexed by:  index(.) [50 (61)] </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># But xts range-based subsets do not work...</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">X</span><span class="op">[</span><span class="st">"1980/"</span><span class="op">]</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="co"># Thus a better way is not to index and perform ad-hoc omputations on the xts index</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">unindex</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span class="r-in"><span class="va">X</span><span class="op">[</span><span class="st">"1980/"</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fdiff.html">fdiff</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/index.html" class="external-link">index</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="co"># xts index is internally processed by timeid()</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                PCGDP       LIFEEX GINI ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1980          NA           NA   NA  NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1981   309.62150  0.269365854   NA  NA   162226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1982    98.34802  0.272487805   NA  NA   119331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1983   -78.72879  0.276609756   NA  NA   -74541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1984   481.07564  0.278195122   NA  NA  -205084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1985   846.88924  0.277731707   NA  NA  -269597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1986   702.81344  0.271707317   NA  NA  -173812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1987   631.60512  0.259097561   NA  NA    35563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1988   359.26028  0.245951220   NA  NA   119484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 1989   963.80172  0.232804878   NA  NA   304699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 2001          NA           NA   NA  NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 2002   573.02200  0.402439024  1.5  NA   138417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 2003  -140.79423 -0.100000000 -0.4  NA   138570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jan 2004  -289.69804  0.151219512  0.1  NA    45681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 17 rows ]</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Of course you can also index plain vectors / matrices...</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

