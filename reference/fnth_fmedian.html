<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fast (Grouped, Weighted) N'th Element/Quantile for Matrix-Like Objects — fnth-fmedian • collapse</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Fast (Grouped, Weighted) N'th Element/Quantile for Matrix-Like Objects — fnth-fmedian"><meta name="description" content="fnth (column-wise) returns the n'th smallest element from a set of unsorted elements x corresponding to an integer index (n), or to a probability between 0 and 1. If n is passed as a probability, ties can be resolved using the lower, upper, or average of the possible elements, or (default) continuous quantile estimation. For n &amp;gt; 1, the lower element is always returned (as in sort(x, partial = n)[n]). See Details.
fmedian is a simple wrapper around fnth, which fixes n = 0.5 and (default) ties = &quot;mean&quot;, i.e., it averages eligible elements. See Details. "><meta property="og:description" content="fnth (column-wise) returns the n'th smallest element from a set of unsorted elements x corresponding to an integer index (n), or to a probability between 0 and 1. If n is passed as a probability, ties can be resolved using the lower, upper, or average of the possible elements, or (default) continuous quantile estimation. For n &amp;gt; 1, the lower element is always returned (as in sort(x, partial = n)[n]). See Details.
fmedian is a simple wrapper around fnth, which fixes n = 0.5 and (default) ties = &quot;mean&quot;, i.e., it averages eligible elements. See Details. "><meta property="og:image" content="https://sebkrantz.github.io/collapse/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">collapse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Documentation</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://sebkrantz.github.io/Rblog/">Blog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/rcollapse.bsky.social" aria-label="BlueSky"><span class="fa fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/collapse_R" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SebKrantz/collapse" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fast (Grouped, Weighted) N'th Element/Quantile for Matrix-Like Objects</h1>

      <div class="d-none name"><code>fnth_fmedian.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>fnth</code> (column-wise) returns the n'th smallest element from a set of unsorted elements <code>x</code> corresponding to an integer index (<code>n</code>), or to a probability between 0 and 1. If <code>n</code> is passed as a probability, ties can be resolved using the lower, upper, or average of the possible elements, or (default) continuous quantile estimation. For <code>n &gt; 1</code>, the lower element is always returned (as in <code>sort(x, partial = n)[n]</code>). See Details.</p>
<p><code>fmedian</code> is a simple wrapper around <code>fnth</code>, which fixes <code>n = 0.5</code> and (default) <code>ties = "mean"</code>, i.e., it averages eligible elements. See Details. <!-- %Users may prefer a quantile based definition of the weighted median. --></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     use.g.names <span class="op">=</span> <span class="cn">TRUE</span>, ties <span class="op">=</span> <span class="st">"q7"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     o <span class="op">=</span> <span class="cn">NULL</span>, check.o <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"sorted"</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, ties <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'matrix'</span></span>
<span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     use.g.names <span class="op">=</span> <span class="cn">TRUE</span>, drop <span class="op">=</span> <span class="cn">TRUE</span>, ties <span class="op">=</span> <span class="st">"q7"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'matrix'</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, ties <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, g <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     use.g.names <span class="op">=</span> <span class="cn">TRUE</span>, drop <span class="op">=</span> <span class="cn">TRUE</span>, ties <span class="op">=</span> <span class="st">"q7"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, ties <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'grouped_df'</span></span>
<span><span class="fu">fnth</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">0.5</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     use.g.names <span class="op">=</span> <span class="cn">FALSE</span>, keep.group_vars <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>, stub <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"stub"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     ties <span class="op">=</span> <span class="st">"q7"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'grouped_df'</span></span>
<span><span class="fu">fmedian</span><span class="op">(</span><span class="va">x</span>, w <span class="op">=</span> <span class="cn">NULL</span>, TRA <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"na.rm"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        use.g.names <span class="op">=</span> <span class="cn">FALSE</span>, keep.group_vars <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>, stub <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"stub"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        ties <span class="op">=</span> <span class="st">"mean"</span>, nthreads <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"nthreads"</span><span class="op">]</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric vector, matrix, data frame or grouped data frame (class 'grouped_df').</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>the element to return using a single integer index such that <code>1 &lt; n &lt; NROW(x)</code>, or a probability <code>0 &lt; n &lt; 1</code>. See Details.</p></dd>


<dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>a factor, <code><a href="GRP.html">GRP</a></code> object, atomic vector (internally converted to factor) or a list of vectors / factors (internally converted to a <code><a href="GRP.html">GRP</a></code> object) used to group <code>x</code>.</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>a numeric vector of (non-negative) weights, may contain missing values only where <code>x</code> is also missing.</p></dd>


<dt id="arg-tra">TRA<a class="anchor" aria-label="anchor" href="#arg-tra"></a></dt>
<dd><p>an integer or quoted operator indicating the transformation to perform:
0 - "na"     |     1 - "fill"     |     2 - "replace"     |     3 - "-"     |     4 - "-+"     |     5 - "/"     |     6 - "%"     |     7 - "+"     |     8 - "*"     |     9 - "%%"     |     10 - "-%%". See <code><a href="TRA.html">TRA</a></code>.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>logical. Skip missing values in <code>x</code>. Defaults to <code>TRUE</code> and implemented at very little computational cost. If <code>na.rm = FALSE</code> a <code>NA</code> is returned when encountered.</p></dd>


<dt id="arg-use-g-names">use.g.names<a class="anchor" aria-label="anchor" href="#arg-use-g-names"></a></dt>
<dd><p>logical. Make group-names and add to the result as names (default method) or row-names (matrix and data frame methods). No row-names are generated for <em>data.table</em>'s.</p></dd>


<dt id="arg-ties">ties<a class="anchor" aria-label="anchor" href="#arg-ties"></a></dt>
<dd><p>an integer or character string specifying the method to resolve ties between adjacent qualifying elements:</p><table class="table table"><tr><td><em> Int. </em></td><td></td><td><em> String </em></td><td></td><td><em> Description </em></td></tr><tr><td>1</td><td></td><td>"mean"</td><td></td><td>take the arithmetic mean of all qualifying elements.</td></tr><tr><td>2</td><td></td><td>"min"</td><td></td><td>take the smallest of the elements.</td></tr><tr><td>3</td><td></td><td>"max"</td><td></td><td>take the largest of the elements.</td></tr><tr><td>4-9</td><td></td><td>"qn"</td><td></td><td>continuous quantile types 4-9, see <code><a href="fquantile.html">fquantile</a></code>.</td></tr></table></dd>


<dt id="arg-nthreads">nthreads<a class="anchor" aria-label="anchor" href="#arg-nthreads"></a></dt>
<dd><p>integer. The number of threads to utilize. Parallelism is across groups for grouped computations on vectors and data frames, and at the column-level otherwise. See Details.</p></dd>


<dt id="arg-o">o<a class="anchor" aria-label="anchor" href="#arg-o"></a></dt>
<dd><p>integer. A valid ordering of <code>x</code>, e.g. <code>radixorder(x)</code>. With groups, the grouping needs to be accounted e.g. <code>radixorder(g, x)</code>.</p></dd>


<dt id="arg-check-o">check.o<a class="anchor" aria-label="anchor" href="#arg-check-o"></a></dt>
<dd><p>logical. <code>TRUE</code> checks that each element of <code>o</code> is within <code>[1, length(x)]</code>. The default uses the fact that orderings from <code><a href="radixorder.html">radixorder</a></code> have a <code>"sorted"</code> attribute which let's <code>fnth</code> infer that the ordering is valid. The length and data type of <code>o</code> is always checked, regardless of <code>check.o</code>.</p></dd>


<dt id="arg-drop">drop<a class="anchor" aria-label="anchor" href="#arg-drop"></a></dt>
<dd><p><em>matrix and data.frame method:</em> Logical. <code>TRUE</code> drops dimensions and returns an atomic vector if <code>g = NULL</code> and <code>TRA = NULL</code>.</p></dd>


<dt id="arg-keep-group-vars">keep.group_vars<a class="anchor" aria-label="anchor" href="#arg-keep-group-vars"></a></dt>
<dd><p><em>grouped_df method:</em> Logical. <code>FALSE</code> removes grouping variables after computation.</p></dd>


<dt id="arg-keep-w">keep.w<a class="anchor" aria-label="anchor" href="#arg-keep-w"></a></dt>
<dd><p><em>grouped_df method:</em> Logical. Retain <code>sum</code> of weighting variable after computation (if contained in <code>grouped_df</code>).</p></dd>


<dt id="arg-stub">stub<a class="anchor" aria-label="anchor" href="#arg-stub"></a></dt>
<dd><p>character. If <code>keep.w = TRUE</code> and <code>stub = TRUE</code> (default), the summed weights column is prefixed by <code>"sum."</code>. Users can specify a different prefix through this argument, or set it to <code>FALSE</code> to avoid prefixing.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>for <code>fmedian</code>: further arguments passed to <code>fnth</code> (apart from <code>n</code>). If <code>TRA</code> is used, passing <code>set = TRUE</code> will transform data by reference and return the result invisibly.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>fnth</code> uses a combination of quickselect, quicksort, and radixsort algorithms, combined with several (weighted) quantile estimation methods and, where possible, OpenMP multithreading:</p>
<ul><li><p>without weights, quickselect is used to determine a (lower) order statistic. If <code>ties %!in% c("min", "max")</code> a second order statistic is found by taking the max of the upper part of the partitioned array, and the two statistics are averaged using a simple mean (<code>ties = "mean"</code>), or weighted average according to a <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code> method (<code>ties = "q4"-"q9"</code>). For <code>n = 0.5</code>, all supported quantile methods give the sample median. With matrices, multithreading is always across columns, for vectors and data frames it is across groups unless <code>is.null(g)</code> for data frames.</p></li>
<li><p>with weights and no groups (<code>is.null(g)</code>), <code><a href="radixorder.html">radixorder</a></code> is called internally (on each column of <code>x</code>). The ordering is used to sum the weights in order of <code>x</code> and determine weighted order statistics or quantiles. See details below. Multithreading is disabled as <code><a href="radixorder.html">radixorder</a></code> cannot be called concurrently on the same memory stack.</p></li>
<li><p>with weights and groups (<code>!is.null(g)</code>), R's quicksort algorithm is used to sort the data in each group and return an index which can be used to sum the weights in order and proceed as before. This is multithreaded across columns for matrices, and across groups otherwise.</p></li>
<li><p>in <code>fnth.default</code>, an ordering of <code>x</code> can be supplied to '<code>o</code>' e.g. <code>fnth(x, 0.75, o = radixorder(x))</code>. This dramatically speeds up the estimation both with and without weights, and is useful if <code>fnth</code> is to be invoked repeatedly on the same data. With groups, <code>o</code> needs to also account for the grouping e.g. <code>fnth(x, 0.75, g, o = radixorder(g, x))</code>. Multithreading is possible across groups. See Examples.</p></li>
</ul><p>If <code>n &gt; 1</code>, the result is equivalent to (column-wise) <code>sort(x, partial = n)[n]</code>. Internally, <code>n</code> is converted to a probability using <code>p = (n-1)/(NROW(x)-1)</code>, and that probability is applied to the set of non-missing elements to find the <code>as.integer(p*(fnobs(x)-1))+1L</code>'th element (which corresponds to option <code>ties = "min"</code>). <!-- % Note that it is necessary to subtract and add 1 so that \code{n = 1} corresponds to \code{p = 0} and \code{n = NROW(x)} to \code{p = 1}. %So if \code{n &gt; 1} is used in the presence of missing values, and the default \code{ties = "mean"} is enabled, the resulting element could be the average of two elements. -->
When using grouped computations with <code>n &gt; 1</code>, <code>n</code> is transformed to a probability <code>p = (n-1)/(NROW(x)/ng-1)</code> (where <code>ng</code> contains the number of unique groups in <code>g</code>).</p>
<p>If weights are used and <code>ties = "q4"-"q9"</code>, weighted continuous quantile estimation is done as described in <code><a href="fquantile.html">fquantile</a></code>.</p>
<p>For <code>ties %in% c("mean", "min", "max")</code>, a target partial sum of weights <code>p*sum(w)</code> is calculated, and the weighted n'th element is the element k such that all elements smaller than k have a sum of weights <code>&lt;= p*sum(w)</code>, and all elements larger than k have a sum of weights <code>&lt;= (1 - p)*sum(w)</code>. If the partial-sum of weights (<code>p*sum(w)</code>) is reached exactly for some element k, then (summing from the lower end) both k and k+1 would qualify as the weighted n'th element. If the weight of element k+1 is zero, k, k+1 and k+2 would qualify... . If <code>n &gt; 1</code>, k is chosen (consistent with the unweighted behavior). <!-- %(ensuring that \code{fnth(x, n)}) and \code{fnth(x, n, w = rep(1, NROW(x)))}, always provide the same outcome) -->
If <code>0 &lt; n &lt; 1</code>, the <code>ties</code> option regulates how to resolve such conflicts, yielding lower (<code>ties = "min"</code>: k), upper (<code>ties = "max"</code>: k+2) or average weighted (<code>ties = "mean"</code>: mean(k, k+1, k+2)) n'th elements.</p>
<p>Thus, in the presence of zero weights, the weighted median (default <code>ties = "mean"</code>) can be an arithmetic average of &gt;2 qualifying elements.</p>
<p>For data frames, column-attributes and overall attributes are preserved if <code>g</code> is used or <code>drop = FALSE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The (<code>w</code> weighted) n'th element/quantile of <code>x</code>, grouped by <code>g</code>, or (if <code><a href="TRA.html">TRA</a></code> is used) <code>x</code> transformed by its (grouped, weighted) n'th element/quantile.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fquantile.html">fquantile</a></code>, <code><a href="fmean.html">fmean</a></code>, <code><a href="fmode.html">fmode</a></code>, <a href="fast-statistical-functions.html">Fast Statistical Functions</a>, <a href="collapse-documentation.html">Collapse Overview</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## default vector method</span></span></span>
<span class="r-in"><span><span class="va">mpg</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span></span></span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>                         <span class="co"># Simple nth element: Median (same as fmedian(mpg))</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19.2</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">5</span><span class="op">)</span>                      <span class="co"># 5th smallest element</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14.7</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">mpg</span>, partial <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>         <span class="co"># Same using base R, fnth is 2x faster.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14.7</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span><span class="op">)</span>                   <span class="co"># Third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 22.8</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, w <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>    <span class="co"># Weighted third quartile: Weighted by hp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20.79909</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>        <span class="co"># Simple transformation: Subtract third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  -1.8  -1.8   0.0  -1.4  -4.1  -4.7  -8.5   1.6   0.0  -3.6  -5.0  -6.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  -5.5  -7.6 -12.4 -12.4  -8.1   9.6   7.6  11.1  -1.3  -7.3  -7.6  -9.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  -3.6   4.5   3.2   7.6  -7.0  -3.1  -7.8  -1.4</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span>             <span class="co"># Grouped third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4     6     8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30.40 21.00 16.25 </span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">mtcars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>       <span class="co"># More groups..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4.0.1  4.1.0  4.1.1  6.0.1  6.1.0  8.0.0  8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.000 23.600 31.400 21.000 19.750 16.625 15.600 </span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="GRP.html">GRP</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="op">~</span> <span class="va">cyl</span> <span class="op">+</span> <span class="va">vs</span> <span class="op">+</span> <span class="va">am</span><span class="op">)</span>       <span class="co"># Precomputing groups gives more speed !</span></span></span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4.0.1  4.1.0  4.1.1  6.0.1  6.1.0  8.0.0  8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.000 23.600 31.400 21.000 19.750 16.625 15.600 </span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">g</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>           <span class="co"># Grouped weighted third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4.0.1    4.1.0    4.1.1    6.0.1    6.1.0    8.0.0    8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.00000 23.17474 30.51538 21.00000 19.65610 16.36250 15.54621 </span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">g</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>           <span class="co"># Groupwise subtract third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   0.000   0.000  -8.600   1.650   2.075  -1.650  -2.325   0.800  -0.800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10]  -0.550  -1.950  -0.225   0.675  -1.425  -6.225  -6.225  -1.925   1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  -1.000   2.500  -2.100  -1.125  -1.425  -3.325   2.575  -4.100   0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28]  -1.000   0.200  -1.300  -0.600 -10.000</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, <span class="va">g</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, <span class="st">"-"</span><span class="op">)</span>      <span class="co"># Groupwise subtract weighted third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.0000000  0.0000000 -7.7153846  1.7439024  2.3375000 -1.5560976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -2.0625000  1.2252632 -0.3747368 -0.4560976 -1.8560976  0.0375000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  0.9375000 -1.1625000 -5.9625000 -5.9625000 -1.6625000  1.8846154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] -0.1153846  3.3846154 -1.6747368 -0.8625000 -1.1625000 -3.0625000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  2.8375000 -3.2153846  0.0000000 -0.1153846  0.2537879 -1.3000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] -0.5462121 -9.1153846</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## data.frame method</span></span></span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    mpg    cyl   disp     hp   drat     wt   qsec     vs     am   gear   carb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22.80   8.00 326.00 180.00   3.92   3.61  18.90   1.00   1.00   4.00   4.00 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fnth</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">0.75</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl disp  hp  drat     wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         -1.8  -2 -166 -70 -0.02 -0.990 -2.44 -1  0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     -1.8  -2 -166 -70 -0.02 -0.735 -1.88 -1  0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         0.0  -4 -218 -87 -0.07 -1.290 -0.29  0  0    0   -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    -1.4  -2  -68 -70 -0.84 -0.395  0.54  0 -1   -1   -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -4.1   0   34  -5 -0.77 -0.170 -1.88 -1 -1   -1   -2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -4.7  -2 -101 -75 -1.16 -0.150  1.32  0 -1   -1   -3</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">0.75</span>, <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mpg cyl   disp     hp  drat     wt   qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 26.000   4 120.30  91.00 4.430 2.1400 16.700  0  1  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.0 23.600   4 143.75  96.00 3.810 3.1700 21.455  1  0  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.1 31.400   4 101.55 101.00 4.165 2.2600 19.185  1  1  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.0.1 21.000   6 160.00 142.50 3.900 2.8225 16.740  0  1  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.1.0 19.750   6 233.25 123.00 3.920 3.4450 19.635  1  0  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.0.0 16.625   8 410.00 218.75 3.165 4.3650 17.655  0  0  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span>, <span class="va">vs</span>, <span class="va">am</span><span class="op">)</span>, <span class="fl">0.75</span><span class="op">)</span>   <span class="co"># Another way of doing it..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am    mpg   disp     hp  drat     wt   qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.000 120.30  91.00 4.430 2.1400 16.700  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 23.600 143.75  96.00 3.810 3.1700 21.455  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 31.400 101.55 101.00 4.165 2.2600 19.185  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 21.000 160.00 142.50 3.900 2.8225 16.740  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 19.750 233.25 123.00 3.920 3.4450 19.635  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 16.625 410.00 218.75 3.165 4.3650 17.655  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">0.75</span>, <span class="va">g</span>, use.g.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>   <span class="co"># No row-names generated</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mpg cyl   disp     hp  drat     wt   qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 26.000   4 120.30  91.00 4.430 2.1400 16.700  0  1  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 23.600   4 143.75  96.00 3.810 3.1700 21.455  1  0  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 31.400   4 101.55 101.00 4.165 2.2600 19.185  1  1  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 21.000   6 160.00 142.50 3.900 2.8225 16.740  0  1  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 19.750   6 233.25 123.00 3.920 3.4450 19.635  1  0  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 16.625   8 410.00 218.75 3.165 4.3650 17.655  0  0  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## matrix method</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="quick-conversion.html">qM</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">m</span>, <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    mpg    cyl   disp     hp   drat     wt   qsec     vs     am   gear   carb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22.80   8.00 326.00 180.00   3.92   3.61  18.90   1.00   1.00   4.00   4.00 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fnth</span><span class="op">(</span><span class="va">m</span>, <span class="fl">0.75</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl disp  hp  drat     wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         -1.8  -2 -166 -70 -0.02 -0.990 -2.44 -1  0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     -1.8  -2 -166 -70 -0.02 -0.735 -1.88 -1  0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         0.0  -4 -218 -87 -0.07 -1.290 -0.29  0  0    0   -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    -1.4  -2  -68 -70 -0.84 -0.395  0.54  0 -1   -1   -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -4.1   0   34  -5 -0.77 -0.170 -1.88 -1 -1   -1   -2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -4.7  -2 -101 -75 -1.16 -0.150  1.32  0 -1   -1   -3</span>
<span class="r-in"><span><span class="fu">fnth</span><span class="op">(</span><span class="va">m</span>, <span class="fl">0.75</span>, <span class="va">g</span><span class="op">)</span> <span class="co"># etc..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mpg cyl   disp     hp  drat     wt   qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 26.000   4 120.30  91.00 4.430 2.1400 16.700  0  1  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.0 23.600   4 143.75  96.00 3.810 3.1700 21.455  1  0  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.1 31.400   4 101.55 101.00 4.165 2.2600 19.185  1  1  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.0.1 21.000   6 160.00 142.50 3.900 2.8225 16.740  0  1  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.1.0 19.750   6 233.25 123.00 3.920 3.4450 19.635  1  0  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.0.0 16.625   8 410.00 218.75 3.165 4.3650 17.655  0  0  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 1 row ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## method for grouped data frames - created with dplyr::group_by or fgroup_by</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am    mpg   disp     hp  drat     wt   qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.000 120.30  91.00 4.430 2.1400 16.700  5.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 23.600 143.75  96.00 3.810 3.1700 21.455  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 31.400 101.55 101.00 4.165 2.2600 19.185  4.0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 21.000 160.00 142.50 3.900 2.8225 16.740  4.5    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 19.750 233.25 123.00 3.920 3.4450 19.635  4.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 16.625 410.00 218.75 3.165 4.3650 17.655  3.0    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span>, <span class="va">hp</span><span class="op">)</span>         <span class="co"># Weighted</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am sum.hp      mpg     disp     drat       wt     qsec     gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1     91 26.00000 120.3000 4.430000 2.140000 16.70000 5.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0    254 23.17474 142.1818 3.827947 3.159368 21.69076 4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1    564 30.51538 106.7863 4.113280 2.308710 18.95614 4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1    395 21.00000 160.0000 3.900000 2.806989 16.65727 4.685714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0    461 19.65610 231.6000 3.920000 3.443333 19.56232 4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0   2330 16.36250 421.7391 3.198673 4.753537 17.67291 3.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 5.371429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span>, TRA <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>  <span class="co"># Divide by third quartile</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   cyl vs am       mpg      disp        hp      drat        wt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           6  0  1 1.0000000 1.0000000 0.7719298 1.0000000 0.9282551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       6  0  1 1.0000000 1.0000000 0.7719298 1.0000000 1.0186005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710          4  1  1 0.7261146 1.0635155 0.9207921 0.9243697 1.0265487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      6  1  0 1.0835443 1.1061093 0.8943089 0.7857143 0.9332366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   8  0  0 1.1248120 0.8780488 0.8000000 0.9952607 0.7880871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             6  1  0 0.9164557 0.9646302 0.8536585 0.7040816 1.0043541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        qsec      gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         0.9832736 0.8888889 0.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     1.0167264 0.8888889 0.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        0.9700287 1.0000000 0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    0.9900688 0.7500000 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout 0.9640329 1.0000000 0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           1.0297937 0.7500000 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 26 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="select_replace_vars.html">fselect</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span> <span class="op">|&gt;</span>    <span class="co"># Faster selecting</span></span></span>
<span class="r-in"><span>      <span class="fu">fnth</span><span class="op">(</span><span class="fl">0.75</span>, <span class="va">hp</span>, <span class="st">"/"</span><span class="op">)</span>  <span class="co"># Divide mpg by its third weighted group-quartile, using hp as weights</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      hp       mpg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           110 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       110 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710           93 0.7471641</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      110 1.0887207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   175 1.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             105 0.9208339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Duster 360          245 0.8739496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 240D            62 1.0528706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 230             95 0.9838299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280            123 0.9767961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280C           123 0.9055714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SE          180 1.0022918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SL          180 1.0572956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SLC         180 0.9289534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cadillac Fleetwood  205 0.6355997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lincoln Continental 215 0.6355997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chrysler Imperial   230 0.8983957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat 128             66 1.0617595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honda Civic          52 0.9962188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corolla       65 1.1109150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corona        97 0.9277344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dodge Challenger    150 0.9472880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMC Javelin         150 0.9289534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Camaro Z28          245 0.8128342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pontiac Firebird    175 1.1734148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat X1-9            66 0.8946307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Porsche 914-2        91 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lotus Europa        113 0.9962188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ford Pantera L      264 1.0163247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ferrari Dino        175 0.9380952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maserati Bora       335 0.9648653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Volvo 142E          109 0.7012856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Efficient grouped estimation of multiple quantiles</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ftransform.html">fmutate</a></span><span class="op">(</span>o <span class="op">=</span> <span class="fu"><a href="radixorder.html">radixorder</a></span><span class="op">(</span><span class="fu"><a href="GRP.html">GRPid</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="fsummarise.html">fsummarise</a></span><span class="op">(</span>mpg_Q1 <span class="op">=</span> <span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.25</span>, o <span class="op">=</span> <span class="va">o</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               mpg_median <span class="op">=</span> <span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, o <span class="op">=</span> <span class="va">o</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               mpg_Q3 <span class="op">=</span> <span class="fu">fnth</span><span class="op">(</span><span class="va">mpg</span>, <span class="fl">0.75</span>, o <span class="op">=</span> <span class="va">o</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am mpg_Q1 mpg_median mpg_Q3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.000      26.00 26.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 22.150      22.80 23.600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 25.050      30.40 31.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 20.350      21.00 21.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 18.025      18.65 19.750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 14.050      15.20 16.625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   8  0  1 15.200      15.40 15.600</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fmedian()</span></span></span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>                         <span class="co"># Simple median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19.2</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, w <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>          <span class="co"># Weighted median: Weighted by hp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 16.4</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>              <span class="co"># Simple transformation: Subtract median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1.8  1.8  3.6  2.2 -0.5 -1.1 -4.9  5.2  3.6  0.0 -1.4 -2.8 -1.9 -4.0 -8.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] -8.8 -4.5 13.2 11.2 14.7  2.3 -3.7 -4.0 -5.9  0.0  8.1  6.8 11.2 -3.4  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] -4.2  2.2</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span>             <span class="co"># Grouped median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4    6    8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.0 19.7 15.2 </span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">mtcars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>       <span class="co"># More groups..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 4.1.0 4.1.1 6.0.1 6.1.0 8.0.0 8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.00 22.80 30.40 21.00 18.65 15.20 15.40 </span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 4.1.0 4.1.1 6.0.1 6.1.0 8.0.0 8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.00 22.80 30.40 21.00 18.65 15.20 15.40 </span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">g</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>           <span class="co"># Grouped weighted median</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 4.1.0 4.1.1 6.0.1 6.1.0 8.0.0 8.0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  26.0  22.8  30.4  21.0  19.2  15.2  15.0 </span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">g</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>           <span class="co"># Groupwise subtract median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.00  0.00 -7.60  2.75  3.50 -0.55 -0.90  1.60  0.00  0.55 -0.85  1.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  2.10  0.00 -4.80 -4.80 -0.50  2.00  0.00  3.50 -1.30  0.30  0.00 -1.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  4.00 -3.10  0.00  0.00  0.40 -1.30 -0.40 -9.00</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">g</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, <span class="st">"-"</span><span class="op">)</span>      <span class="co"># Groupwise subtract weighted median value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.0  0.0 -7.6  2.2  3.5 -1.1 -0.9  1.6  0.0  0.0 -1.4  1.2  2.1  0.0 -4.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] -4.8 -0.5  2.0  0.0  3.5 -1.3  0.3  0.0 -1.9  4.0 -3.1  0.0  0.0  0.8 -1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31]  0.0 -9.0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## data.frame method</span></span></span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mpg     cyl    disp      hp    drat      wt    qsec      vs      am    gear </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  19.200   6.000 196.300 123.000   3.695   3.325  17.710   0.000   0.000   4.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    carb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.000 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mtcars</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl  disp  hp   drat     wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4          1.8   0 -36.3 -13  0.205 -0.705 -1.25  0  1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag      1.8   0 -36.3 -13  0.205 -0.450 -0.69  0  1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         3.6  -2 -88.3 -30  0.155 -1.005  0.90  1  1    0   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive     2.2   0  61.7 -13 -0.615 -0.110  1.73  1  0   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -0.5   2 163.7  52 -0.545  0.115 -0.69  0  0   -1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -1.1   0  28.7 -18 -0.935  0.135  2.51  1  0   -1   -1</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mpg cyl  disp    hp  drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 26.00   4 120.3  91.0 4.430 2.140 16.70  0  1  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.0 22.80   4 140.8  95.0 3.700 3.150 20.01  1  0  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.1 30.40   4  79.0  66.0 4.080 1.935 18.61  1  1  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.0.1 21.00   6 160.0 110.0 3.900 2.770 16.46  0  1  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.1.0 18.65   6 196.3 116.5 3.500 3.440 19.17  1  0  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.0.0 15.20   8 355.0 180.0 3.075 3.810 17.35  0  0  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span>, <span class="va">vs</span>, <span class="va">am</span><span class="op">)</span><span class="op">)</span>   <span class="co"># Another way of doing it..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am   mpg  disp    hp  drat    wt  qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.00 120.3  91.0 4.430 2.140 16.70  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 22.80 140.8  95.0 3.700 3.150 20.01  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 30.40  79.0  66.0 4.080 1.935 18.61  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 21.00 160.0 110.0 3.900 2.770 16.46  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 18.65 196.3 116.5 3.500 3.440 19.17  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 15.20 355.0 180.0 3.075 3.810 17.35  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">g</span>, use.g.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>   <span class="co"># No row-names generated</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mpg cyl  disp    hp  drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 26.00   4 120.3  91.0 4.430 2.140 16.70  0  1  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 22.80   4 140.8  95.0 3.700 3.150 20.01  1  0  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 30.40   4  79.0  66.0 4.080 1.935 18.61  1  1  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 21.00   6 160.0 110.0 3.900 2.770 16.46  0  1  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 18.65   6 196.3 116.5 3.500 3.440 19.17  1  0  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 15.20   8 355.0 180.0 3.075 3.810 17.35  0  0  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## matrix method</span></span></span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mpg     cyl    disp      hp    drat      wt    qsec      vs      am    gear </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  19.200   6.000 196.300 123.000   3.695   3.325  17.710   0.000   0.000   4.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    carb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.000 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">fmedian</span><span class="op">(</span><span class="va">m</span>, TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl  disp  hp   drat     wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4          1.8   0 -36.3 -13  0.205 -0.705 -1.25  0  1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag      1.8   0 -36.3 -13  0.205 -0.450 -0.69  0  1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710         3.6  -2 -88.3 -30  0.155 -1.005  0.90  1  1    0   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive     2.2   0  61.7 -13 -0.615 -0.110  1.73  1  0   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout -0.5   2 163.7  52 -0.545  0.115 -0.69  0  0   -1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant           -1.1   0  28.7 -18 -0.935  0.135  2.51  1  0   -1   -1</span>
<span class="r-in"><span><span class="fu">fmedian</span><span class="op">(</span><span class="va">m</span>, <span class="va">g</span><span class="op">)</span> <span class="co"># etc..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mpg cyl  disp    hp  drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.0.1 26.00   4 120.3  91.0 4.430 2.140 16.70  0  1  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.0 22.80   4 140.8  95.0 3.700 3.150 20.01  1  0  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.1.1 30.40   4  79.0  66.0 4.080 1.935 18.61  1  1  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.0.1 21.00   6 160.0 110.0 3.900 2.770 16.46  0  1  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.1.0 18.65   6 196.3 116.5 3.500 3.440 19.17  1  0  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.0.0 15.20   8 355.0 180.0 3.075 3.810 17.35  0  0  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 1 row ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## method for grouped data frames - created with dplyr::group_by or fgroup_by</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">fmedian</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am   mpg  disp    hp  drat    wt  qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1 26.00 120.3  91.0 4.430 2.140 16.70  5.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0 22.80 140.8  95.0 3.700 3.150 20.01  4.0  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1 30.40  79.0  66.0 4.080 1.935 18.61  4.0  1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1 21.00 160.0 110.0 3.900 2.770 16.46  4.0  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0 18.65 196.3 116.5 3.500 3.440 19.17  3.5  2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0 15.20 355.0 180.0 3.075 3.810 17.35  3.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">fmedian</span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>           <span class="co"># Weighted</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cyl vs am sum.hp  mpg  disp drat    wt  qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4  0  1     91 26.0 120.3 4.43 2.140 16.70    5    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4  1  0    254 22.8 140.8 3.70 3.150 20.01    4    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4  1  1    564 30.4  95.1 4.08 1.935 18.61    4    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   6  0  1    395 21.0 160.0 3.90 2.770 16.46    4    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0    461 19.2 167.6 3.92 3.440 18.90    4    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8  0  0   2330 15.2 360.0 3.08 3.840 17.40    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">fmedian</span><span class="op">(</span>TRA <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>    <span class="co"># De-median</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   cyl vs am   mpg disp    hp   drat     wt  qsec gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           6  0  1  0.00  0.0   0.0  0.000 -0.150  0.00  0.0  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       6  0  1  0.00  0.0   0.0  0.000  0.105  0.56  0.0  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710          4  1  1 -7.60 29.0  27.0 -0.230  0.385  0.00  0.0  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      6  1  0  2.75 61.7  -6.5 -0.420 -0.225  0.27 -0.5 -1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   8  0  0  3.50  5.0  -5.0  0.075 -0.370 -0.33  0.0 -1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             6  1  0 -0.55 28.7 -11.5 -0.740  0.020  1.05 -0.5 -1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 26 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="select_replace_vars.html">fselect</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="co"># Faster selecting</span></span></span>
<span class="r-in"><span>      <span class="fu">fmedian</span><span class="op">(</span><span class="va">hp</span>, <span class="st">"-"</span><span class="op">)</span>  <span class="co"># Weighted de-median mpg, using hp as weights</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      hp  mpg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           110  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       110  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710           93 -7.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      110  2.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   175  3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             105 -1.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Duster 360          245 -0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 240D            62  1.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 230             95  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280            123  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280C           123 -1.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SE          180  1.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SL          180  2.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SLC         180  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cadillac Fleetwood  205 -4.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lincoln Continental 215 -4.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chrysler Imperial   230 -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat 128             66  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honda Civic          52  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corolla       65  3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corona        97 -1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dodge Challenger    150  0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMC Javelin         150  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Camaro Z28          245 -1.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pontiac Firebird    175  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat X1-9            66 -3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Porsche 914-2        91  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lotus Europa        113  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ford Pantera L      264  0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ferrari Dino        175 -1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maserati Bora       335  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Volvo 142E          109 -9.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped by:  cyl, vs, am  [7 | 5 (3.8) 1-12] </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

