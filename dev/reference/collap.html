<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Advanced Data Aggregation — collap • collapse</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Advanced Data Aggregation — collap"><meta name="description" content="collap is a fast and versatile multi-purpose data aggregation command.
It performs simple and weighted aggregations, multi-type aggregations automatically applying different functions to numeric and categorical columns, multi-function aggregations applying multiple functions to each column, and fully custom aggregations where the user passes a list mapping functions to columns.

"><meta property="og:description" content="collap is a fast and versatile multi-purpose data aggregation command.
It performs simple and weighted aggregations, multi-type aggregations automatically applying different functions to numeric and categorical columns, multi-function aggregations applying multiple functions to each column, and fully custom aggregations where the user passes a list mapping functions to columns.

"><meta property="og:image" content="https://sebkrantz.github.io/collapse/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">collapse</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Documentation</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://sebkrantz.github.io/Rblog/">Blog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/rcollapse.bsky.social" aria-label="BlueSky"><span class="fa fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/collapse_R" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SebKrantz/collapse" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Advanced Data Aggregation</h1>

      <div class="d-none name"><code>collap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>collap</code> is a fast and versatile multi-purpose data aggregation command.</p>
<p>It performs simple and weighted aggregations, multi-type aggregations automatically applying different functions to numeric and categorical columns, multi-function aggregations applying multiple functions to each column, and fully custom aggregations where the user passes a list mapping functions to columns.</p>


    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Main function: allows formula and data input to `by` and `w` arguments</span></span>
<span><span class="fu">collap</span><span class="op">(</span><span class="va">X</span>, <span class="va">by</span>, FUN <span class="op">=</span> <span class="va">fmean</span>, catFUN <span class="op">=</span> <span class="va">fmode</span>, cols <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, wFUN <span class="op">=</span> <span class="va">fsum</span>,</span>
<span>       custom <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, keep.by <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>, keep.col.order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       sort <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"sort"</span><span class="op">]</span><span class="op">]</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span>, na.last <span class="op">=</span> <span class="cn">TRUE</span>, return.order <span class="op">=</span> <span class="va">sort</span>,</span>
<span>       method <span class="op">=</span> <span class="st">"auto"</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span>, mc.cores <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>       return <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wide"</span>,<span class="st">"list"</span>,<span class="st">"long"</span>,<span class="st">"long_dupl"</span><span class="op">)</span>, give.names <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Programmer function: allows column names and indices input to `by` and `w` arguments</span></span>
<span><span class="fu">collapv</span><span class="op">(</span><span class="va">X</span>, <span class="va">by</span>, FUN <span class="op">=</span> <span class="va">fmean</span>, catFUN <span class="op">=</span> <span class="va">fmode</span>, cols <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, wFUN <span class="op">=</span> <span class="va">fsum</span>,</span>
<span>        custom <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, keep.by <span class="op">=</span> <span class="cn">TRUE</span>, keep.w <span class="op">=</span> <span class="cn">TRUE</span>, keep.col.order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        sort <span class="op">=</span> <span class="va">.op</span><span class="op">[[</span><span class="st">"sort"</span><span class="op">]</span><span class="op">]</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span>, na.last <span class="op">=</span> <span class="cn">TRUE</span>, return.order <span class="op">=</span> <span class="va">sort</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"auto"</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span>, mc.cores <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>        return <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wide"</span>,<span class="st">"list"</span>,<span class="st">"long"</span>,<span class="st">"long_dupl"</span><span class="op">)</span>, give.names <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Auxiliary function: for grouped data ('grouped_df') input + non-standard evaluation</span></span>
<span><span class="fu">collapg</span><span class="op">(</span><span class="va">X</span>, FUN <span class="op">=</span> <span class="va">fmean</span>, catFUN <span class="op">=</span> <span class="va">fmode</span>, cols <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, wFUN <span class="op">=</span> <span class="va">fsum</span>,</span>
<span>        custom <span class="op">=</span> <span class="cn">NULL</span>, keep.group_vars <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a data frame, or an object coercible to data frame using <code><a href="quick-conversion.html">qDF</a></code>.</p></dd>

  <dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>for <code>collap</code>: a one-or two sided formula, i.e. <code>~ group1</code> or <code>var1 + var2 ~ group1 + group2</code>, or a atomic vector, list of vectors or <code><a href="GRP.html">GRP</a></code> object used to group <code>X</code>. For <code>collapv</code>: names or indices of grouping columns, or a logical vector or selector function such as <code><a href="small-helpers.html">is_categorical</a></code> selecting grouping columns.</p></dd>

<dt id="arg-fun">FUN<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>a function, list of functions (i.e. <code>list(fsum, fmean, fsd)</code> or <code>list(sd = fsd, myfun1 = function(x)..)</code>), or a character vector of function names, which are automatically applied only to numeric variables.</p></dd>

<dt id="arg-catfun">catFUN<a class="anchor" aria-label="anchor" href="#arg-catfun"></a></dt>
<dd><p>same as <code>FUN</code>, but applied only to categorical (non-numeric) typed columns (<code><a href="small-helpers.html">is_categorical</a></code>).</p></dd>

<dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p>select columns to aggregate using a function, column names, indices or logical vector. <em>Note</em>: <code>cols</code> is ignored if a two-sided formula is passed to <code>by</code>.</p></dd>

<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>weights. Can be passed as numeric vector or alternatively as formula i.e. <code>~ weightvar</code> in <code>collap</code> or column name / index etc. i.e. <code>"weightvar"</code> in <code>collapv</code>. <code>collapg</code> supports non-standard evaluations so <code>weightvar</code> can be indicated without quotes.</p></dd>

<dt id="arg-wfun">wFUN<a class="anchor" aria-label="anchor" href="#arg-wfun"></a></dt>
<dd><p>same as <code>FUN</code>: Function(s) to aggregate weight variable if <code>keep.w = TRUE</code>. By default the sum of the weights is computed in each group.</p></dd>


<dt id="arg-custom">custom<a class="anchor" aria-label="anchor" href="#arg-custom"></a></dt>
<dd><p>a named list specifying a fully customized aggregation task. The names of the list are function names and the content columns to aggregate using this function (same input as <code>cols</code>). For example <code>custom = list(fmean = 1:6, fsd = 7:9, fmode = 10:11)</code> tells <code>collap</code> to aggregate columns 1-6 of <code>X</code> using the mean, columns 7-9 using the standard deviation etc. <em>Notes</em>: <code>custom</code> lets <code>collap</code> ignore any inputs passed to <code>FUN</code>, <code>catFUN</code> or <code>cols</code>. Since v1.6.0 you can also rename columns e.g. <code>custom = list(fmean = c(newname = "col1", "col2"), fmode = c(newname = 3))</code>.</p></dd>

<dt id="arg-keep-by-keep-group-vars">keep.by, keep.group_vars<a class="anchor" aria-label="anchor" href="#arg-keep-by-keep-group-vars"></a></dt>
<dd><p>logical. <code>FALSE</code> will omit grouping variables from the output. <code>TRUE</code> keeps the variables, even if passed externally in a list or vector (unlike other <em>collapse</em> functions).</p></dd>

<dt id="arg-keep-w">keep.w<a class="anchor" aria-label="anchor" href="#arg-keep-w"></a></dt>
<dd><p>logical. <code>FALSE</code> will omit weight variable from the output i.e. no aggregation of the weights. <code>TRUE</code> aggregates and adds weights, even if passed externally as a vector (unlike other <em>collapse</em> functions).</p></dd>

<dt id="arg-keep-col-order">keep.col.order<a class="anchor" aria-label="anchor" href="#arg-keep-col-order"></a></dt>
<dd><p>logical. Retain original column order post-aggregation.</p></dd>

<dt id="arg-sort-decreasing-na-last-return-order-method">sort, decreasing, na.last, return.order, method<a class="anchor" aria-label="anchor" href="#arg-sort-decreasing-na-last-return-order-method"></a></dt>
<dd><p>logical / character. Arguments passed to <code><a href="GRP.html">GRP.default</a></code> and affecting the row-order in the aggregated data frame and the grouping algorithm.</p></dd>

<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical. Use <code>mclapply</code> instead of <code>lapply</code> to parallelize the computation at the column level. Not available for Windows.</p></dd>

<dt id="arg-mc-cores">mc.cores<a class="anchor" aria-label="anchor" href="#arg-mc-cores"></a></dt>
<dd><p>integer. Argument to <code>mclapply</code> setting the number of cores to use, default is 2.</p></dd>

<dt id="arg-return">return<a class="anchor" aria-label="anchor" href="#arg-return"></a></dt>
<dd><p>character. Control the output format when aggregating with multiple functions or performing custom aggregation. "wide" (default) returns a wider data frame with added columns for each additional function. "list" returns a list of data frames - one for each function. "long" adds a column "Function" and row-binds the results from different functions using <code><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">data.table::rbindlist</a></code>. "long_dupl" is a special option for aggregating multi-type data using multiple <code>FUN</code> but only one <code>catFUN</code> or vice-versa. In that case the format is long and data aggregated using only one function is duplicated. See Examples.</p></dd>

<dt id="arg-give-names">give.names<a class="anchor" aria-label="anchor" href="#arg-give-names"></a></dt>
<dd><p>logical. Create unique names of aggregated columns by adding a prefix 'FUN.var'. <code>'auto'</code> will automatically create such prefixes whenever multiple functions are applied to a column. <!-- % By default \code{"."} is used as a separator between 'FUN' and 'var'. It is also possible to choose a different separator by specifying \code{give.names = "_"}, for example. --></p></dd>

<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to all functions supplied to <code>FUN</code>, <code>catFUN</code>, <code>wFUN</code> or <code>custom</code>. Since v1.9.0 these are also split by groups for non-<a href="fast-statistical-functions.html">Fast Statistical Functions</a>. The behavior of <a href="fast-statistical-functions.html">Fast Statistical Functions</a> with unused arguments is regulated by <code>option("collapse_unused_arg_action")</code> and defaults to <code>"warning"</code>. <code>collapg</code> also allows other arguments to <code>collap</code> except for <code>sort, decreasing, na.last, return.order, method</code> and <code>keep.by</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>collap</code> automatically checks each function passed to it whether it is a <a href="fast-statistical-functions.html">Fast Statistical Function</a> (i.e. whether the function name is contained in <code>.FAST_STAT_FUN</code>). If the function is a fast statistical function, <code>collap</code> only does the grouping and then calls the function to carry out the grouped computations (vectorized in C/C++), resulting in high aggregation speeds, even with weights. If the function is not one of <code>.FAST_STAT_FUN</code>, <code><a href="BY.html">BY</a></code> is called internally to perform the computation. The resulting computations from each function are put into a list and recombined to produce the desired output format as controlled by the <code>return</code> argument. This is substantially slower, particularly with many groups.</p>
<p>When setting <code>parallel = TRUE</code> on a non-windows computer, aggregations will efficiently be parallelized at the column level using <code>mclapply</code> utilizing <code>mc.cores</code> cores. Some <a href="fast-statistical-functions.html">Fast Statistical Function</a> support multithreading i.e. have an <code>nthreads</code> argument that can be passed to <code>collap</code>. Using C-level multithreading is much more effective than R-level parallelism, and also works on Windows, but the two should never be combined.</p>
<p>When the <code>w</code> argument is used, the weights are passed to all functions except for <code>wFUN</code>. This may be undesirable in settings like <code>collap(data, ~ id, custom = list(fsum = ..., fmean = ...), w = ~ weights)</code> where we wish to aggregate some columns using the weighted mean, and others using a simple sum or another unweighted statistic. <!-- %Since many \link[=fast-statistical-functions]{Fast Statistical Functions} including \code{\link{fsum}} support weights, the above computes a weighted mean and a weighted sum. A couple of workarounds were outlined \href{https://github.com/SebKrantz/collapse/issues/96}{here}, but \emph{collapse} 1.5.0 incorporates an easy solution into \code{collap}: -->
Therefore it is possible to append <a href="fast-statistical-functions.html">Fast Statistical Functions</a> by <code>_uw</code> to yield an unweighted computation. So for the above example one can specify: <code>collap(data, ~ id, custom = list(fsum_uw = ..., fmean = ...), w = ~ weights)</code> to get the weighted mean and the simple sum. <em>Note</em> that the <code>_uw</code> functions are not available for use outside collap. Thus one also needs to quote them when passing to the <code>FUN</code> or <code>catFUN</code> arguments, e.g. use <code>collap(data, ~ id, fmean, "fmode_uw", w = ~ weights)</code>. <!-- %\emph{Note} also that it is never necessary for functions passed to \code{wFUN} to be appended like this, as the weights are never used to aggregate themselves. --></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>X</code> aggregated. If <code>X</code> is not a data frame it is coerced to one using <code><a href="quick-conversion.html">qDF</a></code> and then aggregated.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fsummarise.html">fsummarise</a></code>, <code><a href="BY.html">BY</a></code>, <a href="fast-statistical-functions.html">Fast Statistical Functions</a>, <a href="collapse-documentation.html">Collapse Overview</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## A Simple Introduction --------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          4.7         3.2          1.3         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          4.6         3.1          1.5         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          5.0         3.6          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          5.4         3.9          1.7         0.4  setosa</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span><span class="op">)</span>                                        <span class="co"># Default: FUN = fmean for numeric</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        5.006       3.428        1.462       0.246     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        5.936       2.770        4.260       1.326 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        6.588       2.974        5.552       2.026  virginica</span>
<span class="r-in"><span><span class="fu">collapv</span><span class="op">(</span><span class="va">iris</span>, <span class="fl">5</span><span class="op">)</span>                                               <span class="co"># Same using collapv</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        5.006       3.428        1.462       0.246     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        5.936       2.770        4.260       1.326 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        6.588       2.974        5.552       2.026  virginica</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, <span class="va">fmedian</span><span class="op">)</span>                               <span class="co"># Using the median</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          5.0         3.4         1.50         0.2     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          5.9         2.8         4.35         1.3 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          6.5         3.0         5.55         2.0  virginica</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, <span class="va">fmedian</span>, keep.col.order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>       <span class="co"># Groups in-front</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa          5.0         3.4         1.50         0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor          5.9         2.8         4.35         1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica          6.5         3.0         5.55         2.0</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="va">Sepal.Width</span> <span class="op">+</span> <span class="va">Petal.Width</span> <span class="op">~</span> <span class="va">Species</span>, <span class="va">fmedian</span><span class="op">)</span>     <span class="co"># Only '.Width' columns</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Width Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         3.4         0.2     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2.8         1.3 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         3.0         2.0  virginica</span>
<span class="r-in"><span><span class="fu">collapv</span><span class="op">(</span><span class="va">iris</span>, <span class="fl">5</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>                               <span class="co"># Same using collapv</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Width Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       3.428       0.246     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       2.770       1.326 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       2.974       2.026  virginica</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fmean</span>, <span class="va">fmedian</span><span class="op">)</span><span class="op">)</span>                  <span class="co"># Two functions</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fmean.Sepal.Length fmedian.Sepal.Length fmean.Sepal.Width fmedian.Sepal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              5.006                  5.0             3.428                 3.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              5.936                  5.9             2.770                 2.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              6.588                  6.5             2.974                 3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fmean.Petal.Length fmedian.Petal.Length fmean.Petal.Width fmedian.Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              1.462                 1.50             0.246                 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              4.260                 4.35             1.326                 1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              5.552                 5.55             2.026                 2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fmean</span>, <span class="va">fmedian</span><span class="op">)</span>, return <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span> <span class="co"># Long format</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Function Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    fmean        5.006       3.428        1.462       0.246     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    fmean        5.936       2.770        4.260       1.326 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    fmean        6.588       2.974        5.552       2.026  virginica</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  fmedian        5.000       3.400        1.500       0.200     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  fmedian        5.900       2.800        4.350       1.300 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  fmedian        6.500       3.000        5.550       2.000  virginica</span>
<span class="r-in"><span><span class="fu">collapv</span><span class="op">(</span><span class="va">iris</span>, <span class="fl">5</span>, custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, fmedian <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>    <span class="co"># Custom aggregation</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        5.006       3.428         1.50         0.2     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        5.936       2.770         4.35         1.3 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        6.588       2.974         5.55         2.0  virginica</span>
<span class="r-in"><span><span class="fu">collapv</span><span class="op">(</span><span class="va">iris</span>, <span class="fl">5</span>, custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, fmedian <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,    <span class="co"># Raw output, no column reordering</span></span></span>
<span class="r-in"><span>        return <span class="op">=</span> <span class="st">"list"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fmean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species Sepal.Length Sepal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa        5.006       3.428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor        5.936       2.770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica        6.588       2.974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fmedian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa         1.50         0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor         4.35         1.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica         5.55         2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">collapv</span><span class="op">(</span><span class="va">iris</span>, <span class="fl">5</span>, custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, fmedian <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,    <span class="co"># A strange choice..</span></span></span>
<span class="r-in"><span>        return <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Function Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    fmean        5.006       3.428           NA          NA     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    fmean        5.936       2.770           NA          NA versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    fmean        6.588       2.974           NA          NA  virginica</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  fmedian           NA          NA         1.50         0.2     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  fmedian           NA          NA         4.35         1.3 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  fmedian           NA          NA         5.55         2.0  virginica</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">Sepal.Length</span><span class="op">)</span>                    <span class="co"># Using Sepal.Length as weights, ..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        250.3    3.447423     1.465202   0.2480224     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        296.8    2.784063     4.290195   1.3352089 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        329.4    2.987948     5.597116   2.0333030  virginica</span>
<span class="r-in"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="efficient-programming.html">fnrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="op">~</span> <span class="va">Species</span>, w <span class="op">=</span> <span class="va">weights</span><span class="op">)</span>                           <span class="co"># Some random weights..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    weights Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 49.80442     5.008467    3.439900     1.475742   0.2414042     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 38.71629     5.918589    2.770690     4.235565   1.3112717 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 43.96431     6.530104    2.968984     5.520582   2.0136350  virginica</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, w <span class="op">=</span> <span class="va">weights</span><span class="op">)</span>                        <span class="co"># Note this behavior..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species  weights Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa 49.80442     5.008467    3.439900     1.475742   0.2414042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor 38.71629     5.918589    2.770690     4.235565   1.3112717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica 43.96431     6.530104    2.968984     5.520582   2.0136350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica</span>
<span class="r-in"><span><span class="fu">collap</span><span class="op">(</span><span class="va">iris</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, w <span class="op">=</span> <span class="va">weights</span>,</span></span>
<span class="r-in"><span>       keep.by <span class="op">=</span> <span class="cn">FALSE</span>, keep.w <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     5.008467    3.439900     1.475742   0.2414042     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     5.918589    2.770690     4.235565   1.3112717 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     6.530104    2.968984     5.520582   2.0136350  virginica</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Multi-Type Aggregation --------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">wlddev</span><span class="op">)</span>                                                    <span class="co"># World Development Panel Data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date year decade     region     income  OECD PCGDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1963-01-01 1962   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 1964-01-01 1963   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 1965-01-01 1964   1960 South Asia Low income FALSE    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   LIFEEX GINI       ODA     POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 32.446   NA 116769997 8996973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 32.962   NA 232080002 9169410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 33.471   NA 112839996 9351441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 33.971   NA 237720001 9543205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 34.463   NA 295920013 9744781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span><span class="op">)</span><span class="op">)</span>                        <span class="co"># Aggregate by country and decade</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date   year decade     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   AFG 1961-01-01 1964.5   1960 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1971-01-01 1974.5   1970 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1981-01-01 1984.5   1980 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 1991-01-01 1994.5   1990 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 2001-01-01 2004.5   2000 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 379.373 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>, <span class="va">fmedian</span>, <span class="va">ffirst</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Different functions</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date   year decade     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   AFG 1961-01-01 1964.5   1960 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1971-01-01 1974.5   1970 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1981-01-01 1984.5   1980 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 1991-01-01 1994.5   1990 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 2001-01-01 2004.5   2000 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       NA 34.7055   NA  234900002  9850550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       NA 39.8430   NA  246509995 12551055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       NA 46.4005   NA   48539999 12071250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       NA 53.1200   NA  285175003 17593192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 361.2596 58.0310   NA 2984469971 25190480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>, cols <span class="op">=</span> <span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span>     <span class="co"># Aggregate only numeric columns</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country   year decade decade    PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan 1964.5   1960   1960       NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan 1974.5   1970   1970       NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan 1984.5   1980   1980       NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan 1994.5   1990   1990       NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan 2004.5   2000   2000 379.3730 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan 2014.5   2010   2010 567.4047 63.0715   NA 5023859033 33741195</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>, cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span><span class="op">)</span>           <span class="co"># Only the 5 series</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade    PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960       NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970       NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980       NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990       NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 379.3730 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 567.4047 63.0715   NA 5023859033 33741195</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="va">PCGDP</span> <span class="op">+</span> <span class="va">LIFEEX</span> <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span><span class="op">)</span><span class="op">)</span>         <span class="co"># Only GDP and life-expactancy</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade    PCGDP  LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960       NA 34.6908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970       NA 39.9053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980       NA 46.4176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990       NA 53.0097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 379.3730 58.0881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 567.4047 63.0715</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="va">PCGDP</span> <span class="op">+</span> <span class="va">LIFEEX</span> <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>, <span class="va">fsum</span><span class="op">)</span><span class="op">)</span>   <span class="co"># Using the sum instead</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade    PCGDP  LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960       NA 346.908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970       NA 399.053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980       NA 464.176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990       NA 530.097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 3034.984 580.881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 5674.047 630.715</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="va">PCGDP</span> <span class="op">+</span> <span class="va">LIFEEX</span> <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>, <span class="va">sum</span>,     <span class="co"># Same using base::sum -&gt; slower!</span></span></span>
<span class="r-in"><span>            na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade    PCGDP  LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960    0.000 346.908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970    0.000 399.053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980    0.000 464.176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990    0.000 530.097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 3034.984 580.881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 5674.047 630.715</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="va">wlddev</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>,<span class="st">"decade"</span><span class="op">)</span><span class="op">]</span>, <span class="va">fsum</span>,        <span class="co"># Same, exploring different inputs</span></span></span>
<span class="r-in"><span>            cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade    PCGDP  LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960       NA 346.908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970       NA 399.053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980       NA 464.176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990       NA 530.097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 3034.984 580.881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 5674.047 630.715</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">wlddev</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>,<span class="st">"decade"</span><span class="op">)</span><span class="op">]</span>, <span class="va">fsum</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade    PCGDP  LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960       NA 346.908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970       NA 399.053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980       NA 464.176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990       NA 530.097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 3034.984 580.881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 5674.047 630.715</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collapv</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>,<span class="st">"decade"</span><span class="op">)</span>, <span class="va">fsum</span><span class="op">)</span><span class="op">)</span>              <span class="co"># ..names/indices with collapv</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date  year decade     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   AFG 1961-01-01 19645   1960 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1971-01-01 19745   1970 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1981-01-01 19845   1980 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 1991-01-01 19945   1990 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 2001-01-01 20045   2000 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PCGDP  LIFEEX GINI         ODA       POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       NA 346.908   NA  2222889992  98867731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       NA 399.053   NA  2361699982 124518028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       NA 464.176   NA   716660007 122918537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       NA 530.097   NA  3172550003 169319030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 3034.984 580.881   NA 30540519608 248700217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collapv</span><span class="op">(</span><span class="va">wlddev</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>, <span class="va">fsum</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date  year decade     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   AFG 1961-01-01 19645   1960 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1971-01-01 19745   1970 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1981-01-01 19845   1980 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 1991-01-01 19945   1990 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 2001-01-01 20045   2000 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PCGDP  LIFEEX GINI         ODA       POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       NA 346.908   NA  2222889992  98867731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       NA 399.053   NA  2361699982 124518028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       NA 464.176   NA   716660007 122918537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       NA 530.097   NA  3172550003 169319030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 3034.984 580.881   NA 30540519608 248700217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="GRP.html">GRP</a></span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span><span class="op">)</span>                            <span class="co"># Precomputing the grouping</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="va">g</span>, keep.by <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>                        <span class="co"># This is slightly faster now</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date   year decade     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   AFG 1961-01-01 1964.5   1960 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1971-01-01 1974.5   1970 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1981-01-01 1984.5   1980 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 1991-01-01 1994.5   1990 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 2001-01-01 2004.5   2000 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 379.373 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="co"># Aggregate categorical data using not the mode but the last element</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>, <span class="va">fmean</span>, <span class="va">flast</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country iso3c       date   year decade     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   AFG 1970-01-01 1964.5   1960 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   AFG 1980-01-01 1974.5   1970 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   AFG 1990-01-01 1984.5   1980 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   AFG 2000-01-01 1994.5   1990 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   AFG 2010-01-01 2004.5   2000 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 379.373 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>, catFUN <span class="op">=</span> <span class="va">flast</span>,         <span class="co"># Aggregate only categorical data</span></span></span>
<span class="r-in"><span>            cols <span class="op">=</span> <span class="va">is_categorical</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country     country iso3c       date decade     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan Afghanistan   AFG 1970-01-01   1960 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan Afghanistan   AFG 1980-01-01   1970 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan Afghanistan   AFG 1990-01-01   1980 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan Afghanistan   AFG 2000-01-01   1990 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan Afghanistan   AFG 2010-01-01   2000 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan Afghanistan   AFG 2020-01-01   2010 South Asia Low income FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Weighted Aggregation ----------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># We aggregate to region level using population weights</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">region</span> <span class="op">+</span> <span class="va">year</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">POP</span><span class="op">)</span><span class="op">)</span>                <span class="co"># Takes weighted mean for numeric..</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   country iso3c       date year decade              region              income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   China   CHN 1961-01-01 1960   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   China   CHN 1962-01-01 1961   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   China   CHN 1963-01-01 1962   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   China   CHN 1964-01-01 1963   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   China   CHN 1965-01-01 1964   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    OECD    PCGDP   LIFEEX GINI       ODA        POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 FALSE 1313.760 48.20996   NA 764164132 1018832214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 FALSE 1395.228 48.73451   NA 774544481 1021806689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 FALSE 1463.441 49.39960   NA 915939856 1035694621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 FALSE 1540.621 50.37529   NA 748978431 1060888744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 FALSE 1665.385 51.57330   NA 619226983 1085690423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="co"># ..and weighted mode for categorical data. The weight vector is aggregated using fsum</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">region</span> <span class="op">+</span> <span class="va">year</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">POP</span>,                 <span class="co"># Aggregating weights using sum</span></span></span>
<span class="r-in"><span>            wFUN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sum <span class="op">=</span> <span class="va">fsum</span>, max <span class="op">=</span> <span class="va">fmax</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>               <span class="co"># and max (corresponding to mode)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   country iso3c       date year decade              region              income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   China   CHN 1961-01-01 1960   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   China   CHN 1962-01-01 1961   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   China   CHN 1963-01-01 1962   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   China   CHN 1964-01-01 1963   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   China   CHN 1965-01-01 1964   1960 East Asia &amp; Pacific Upper middle income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    OECD    PCGDP   LIFEEX GINI       ODA    sum.POP   max.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 FALSE 1313.760 48.20996   NA 764164132 1018832214 667070000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 FALSE 1395.228 48.73451   NA 774544481 1021806689 660330000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 FALSE 1463.441 49.39960   NA 915939856 1035694621 665770000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 FALSE 1540.621 50.37529   NA 748978431 1060888744 682335000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 FALSE 1665.385 51.57330   NA 619226983 1085690423 698355000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Multi-Function Aggregation ----------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">fmean</span>, N <span class="op">=</span> <span class="va">fnobs</span><span class="op">)</span>,  <span class="co"># Saving mean and Nobs</span></span></span>
<span class="r-in"><span>            cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade mean.PCGDP N.PCGDP mean.LIFEEX N.LIFEEX mean.GINI N.GINI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960         NA       0     34.6908       10        NA      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970         NA       0     39.9053       10        NA      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980         NA       0     46.4176       10        NA      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990         NA       0     53.0097       10        NA      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000    379.373       8     58.0881       10        NA      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mean.ODA N.ODA mean.POP N.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  222288999    10  9886773    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  236169998    10 12451803    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   71666001    10 12291854    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  317255000    10 16931903    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 3054051961    10 24870022    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># Same using base R -&gt; slower</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>                 N <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">13</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade mean.PCGDP N.PCGDP mean.LIFEEX N.LIFEEX mean.GINI N.GINI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960        NaN       0     34.6908       10       NaN      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970        NaN       0     39.9053       10       NaN      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980        NaN       0     46.4176       10       NaN      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990        NaN       0     53.0097       10       NaN      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000    379.373       8     58.0881       10       NaN      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mean.ODA N.ODA mean.POP N.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  222288999    10  9886773    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  236169998    10 12451803    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   71666001    10 12291854    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  317255000    10 16931903    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 3054051961    10 24870022    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                       <span class="co"># List output format</span></span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">fmean</span>, N <span class="op">=</span> <span class="va">fnobs</span><span class="op">)</span>, cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">13</span>, return <span class="op">=</span> <span class="st">"list"</span><span class="op">)</span>, <span class="va">head</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade    PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960       NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970       NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980       NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990       NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 379.3730 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 567.4047 63.0715   NA 5023859033 33741195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade PCGDP LIFEEX GINI ODA POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960     0     10    0  10  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970     0     10    0  10  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980     0     10    0  10  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990     0     10    0  10  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000     8     10    0  10  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010    10     10    0  10  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># Long output format</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">fmean</span>, N <span class="op">=</span> <span class="va">fnobs</span><span class="op">)</span>, cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">13</span>, return <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Function     country decade    PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     mean Afghanistan   1960       NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     mean Afghanistan   1970       NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     mean Afghanistan   1980       NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     mean Afghanistan   1990       NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     mean Afghanistan   2000 379.3730 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     mean Afghanistan   2010 567.4047 63.0715   NA 5023859033 33741195</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># Also aggregating categorical data,</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">fmean</span>, N <span class="op">=</span> <span class="va">fnobs</span><span class="op">)</span>, return <span class="op">=</span> <span class="st">"long_dupl"</span><span class="op">)</span><span class="op">)</span>      <span class="co"># and duplicating it 2 times</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Function     country iso3c       date   year decade     region     income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     mean Afghanistan   AFG 1961-01-01 1964.5   1960 South Asia Low income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     mean Afghanistan   AFG 1971-01-01 1974.5   1970 South Asia Low income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     mean Afghanistan   AFG 1981-01-01 1984.5   1980 South Asia Low income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     mean Afghanistan   AFG 1991-01-01 1994.5   1990 South Asia Low income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     mean Afghanistan   AFG 2001-01-01 2004.5   2000 South Asia Low income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    OECD   PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 FALSE      NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 FALSE      NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 FALSE      NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 FALSE      NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 FALSE 379.373 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># Now also using 2 functions on</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">fmean</span>, N <span class="op">=</span> <span class="va">fnobs</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="va">fmode</span>, last <span class="op">=</span> <span class="va">flast</span><span class="op">)</span>,   <span class="co"># categorical data</span></span></span>
<span class="r-in"><span>            keep.col.order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade mean.year mean.PCGDP mean.LIFEEX mean.GINI  mean.ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960    1964.5         NA     34.6908        NA 222288999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970    1974.5         NA     39.9053        NA 236169998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean.POP N.year N.PCGDP N.LIFEEX N.GINI N.ODA N.POP mode.iso3c  mode.date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  9886773     10       0       10      0    10    10        AFG 1961-01-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 12451803     10       0       10      0    10    10        AFG 1971-01-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mode.region mode.income mode.OECD last.iso3c  last.date last.region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  South Asia  Low income     FALSE        AFG 1970-01-01  South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  South Asia  Low income     FALSE        AFG 1980-01-01  South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   last.income last.OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Low income     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Low income     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 4 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># More functions, string input,</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fmean"</span>,<span class="st">"fsum"</span>,<span class="st">"fnobs"</span>,<span class="st">"fsd"</span>,<span class="st">"fvar"</span><span class="op">)</span>,             <span class="co"># parallelized execution</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fmode"</span>,<span class="st">"ffirst"</span>,<span class="st">"flast"</span>,<span class="st">"fndistinct"</span><span class="op">)</span>,           <span class="co"># (choose more than 1 cores,</span></span></span>
<span class="r-in"><span>            parallel <span class="op">=</span> <span class="cn">TRUE</span>, mc.cores <span class="op">=</span> <span class="fl">1L</span>,                     <span class="co"># depending on your machine)</span></span></span>
<span class="r-in"><span>            keep.col.order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade fmean.year fmean.PCGDP fmean.LIFEEX fmean.GINI fmean.ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960     1964.5          NA      34.6908         NA 222288999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fmean.POP fsum.year fsum.PCGDP fsum.LIFEEX fsum.GINI   fsum.ODA fsum.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   9886773     19645         NA     346.908        NA 2222889992 98867731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fnobs.year fnobs.PCGDP fnobs.LIFEEX fnobs.GINI fnobs.ODA fnobs.POP fsd.year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         10           0           10          0        10        10  3.02765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fsd.PCGDP fsd.LIFEEX fsd.GINI  fsd.ODA  fsd.POP fvar.year fvar.PCGDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        NA   1.490964       NA 80884369 637640.4  9.166667         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fvar.LIFEEX fvar.GINI     fvar.ODA     fvar.POP fmode.iso3c fmode.date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2.222975        NA 6.542281e+15 406585329709         AFG 1961-01-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fmode.region fmode.income fmode.OECD ffirst.iso3c ffirst.date ffirst.region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   South Asia   Low income      FALSE          AFG  1961-01-01    South Asia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ffirst.income ffirst.OECD flast.iso3c flast.date flast.region flast.income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Low income       FALSE         AFG 1970-01-01   South Asia   Low income</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flast.OECD fndistinct.iso3c fndistinct.date fndistinct.region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      FALSE                1              10                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fndistinct.income fndistinct.OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 1               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 5 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Custom Aggregation ------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># Custom aggregation</span></span></span>
<span class="r-in"><span>            custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">13</span>, fsd <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">10</span>, fmode <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade     income  OECD    PCGDP   LIFEEX GINI        ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960 Low income FALSE       NA 1.490964   NA  222288999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970 Low income FALSE       NA 1.738383   NA  236169998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980 Low income FALSE       NA 2.161460   NA   71666001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990 Low income FALSE       NA 1.695424   NA  317255000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 Low income FALSE 53.66524 1.565630   NA 3054051961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 Low income FALSE 18.07999 1.274644   NA 5023859033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 33741195</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># Using column names</span></span></span>
<span class="r-in"><span>            custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="st">"PCGDP"</span>, fsd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LIFEEX"</span>,<span class="st">"GINI"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          flast <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country       date decade    PCGDP   LIFEEX GINI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan 1970-01-01   1960       NA 1.490964   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan 1980-01-01   1970       NA 1.738383   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan 1990-01-01   1980       NA 2.161460   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan 2000-01-01   1990       NA 1.695424   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan 2010-01-01   2000 379.3730 1.565630   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan 2020-01-01   2010 567.4047 1.274644   NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># Weighted parallelized custom</span></span></span>
<span class="r-in"><span>            custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">12</span>, fsd <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,             <span class="co"># aggregation</span></span></span>
<span class="r-in"><span>                          fmode <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">POP</span>,</span></span>
<span class="r-in"><span>            wFUN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fsum</span>, <span class="va">fmax</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            parallel <span class="op">=</span> <span class="cn">TRUE</span>, mc.cores <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade fmode.income fmode.OECD fmean.PCGDP fsd.PCGDP fmean.LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960   Low income      FALSE          NA        NA     34.77716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970   Low income      FALSE          NA        NA     40.00367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980   Low income      FALSE          NA        NA     46.32098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990   Low income      FALSE          NA        NA     53.25897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000   Low income      FALSE    382.5583  51.11423     58.23630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fsd.LIFEEX fmean.GINI  fmean.ODA  fsum.POP fmax.POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1.413369         NA  223006447  98867731 10893776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1.643608         NA  236798314 124518028 13411056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2.061847         NA   70613923 122918537 13356511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1.556185         NA  306818649 169319030 20170844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1.476279         NA 3240143310 248700217 28394813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">collap</span><span class="op">(</span><span class="va">wlddev</span>, <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">decade</span>,                         <span class="co"># No column reordering</span></span></span>
<span class="r-in"><span>            custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">12</span>, fsd <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>                          fmode <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>, w <span class="op">=</span> <span class="op">~</span> <span class="va">POP</span>,</span></span>
<span class="r-in"><span>            wFUN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fsum</span>, <span class="va">fmax</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            parallel <span class="op">=</span> <span class="cn">TRUE</span>, mc.cores <span class="op">=</span> <span class="fl">1L</span>, keep.col.order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade  fsum.POP fmax.POP fmean.PCGDP fmean.LIFEEX fmean.GINI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960  98867731 10893776          NA     34.77716         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970 124518028 13411056          NA     40.00367         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980 122918537 13356511          NA     46.32098         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990 169319030 20170844          NA     53.25897         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 248700217 28394813    382.5583     58.23630         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fmean.ODA fsd.PCGDP fsd.LIFEEX fmode.income fmode.OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  223006447        NA   1.413369   Low income      FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  236798314        NA   1.643608   Low income      FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   70613923        NA   2.061847   Low income      FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  306818649        NA   1.556185   Low income      FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 3240143310  51.11423   1.476279   Low income      FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Piped Use --------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">collapg</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa        5.006       3.428        1.462       0.246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor        5.936       2.770        4.260       1.326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica        6.588       2.974        5.552       2.026</span>
<span class="r-in"><span><span class="va">wlddev</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">decade</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">collapg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade iso3c       date   year     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960   AFG 1961-01-01 1964.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970   AFG 1971-01-01 1974.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980   AFG 1981-01-01 1984.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990   AFG 1991-01-01 1994.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000   AFG 2001-01-01 2004.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA 34.6908   NA  222288999  9886773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA 39.9053   NA  236169998 12451803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      NA 46.4176   NA   71666001 12291854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      NA 53.0097   NA  317255000 16931903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 379.373 58.0881   NA 3054051961 24870022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">wlddev</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">collapg</span><span class="op">(</span>w <span class="op">=</span> <span class="va">POP</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                region year        POP country iso3c       date decade</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 East Asia &amp; Pacific 1960 1018832214   China   CHN 1961-01-01   1960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 East Asia &amp; Pacific 1961 1021806689   China   CHN 1962-01-01   1960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 East Asia &amp; Pacific 1962 1035694621   China   CHN 1963-01-01   1960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 East Asia &amp; Pacific 1963 1060888744   China   CHN 1964-01-01   1960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 East Asia &amp; Pacific 1964 1085690423   China   CHN 1965-01-01   1960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                income  OECD    PCGDP   LIFEEX GINI       ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Upper middle income FALSE 1313.760 48.20996   NA 764164132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Upper middle income FALSE 1395.228 48.73451   NA 774544481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Upper middle income FALSE 1463.441 49.39960   NA 915939856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Upper middle income FALSE 1540.621 50.37529   NA 748978431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Upper middle income FALSE 1665.385 51.57330   NA 619226983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">wlddev</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">decade</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">collapg</span><span class="op">(</span><span class="va">fmedian</span>, <span class="va">flast</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade iso3c       date   year     region     income  OECD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960   AFG 1970-01-01 1964.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970   AFG 1980-01-01 1974.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980   AFG 1990-01-01 1984.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990   AFG 2000-01-01 1994.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000   AFG 2010-01-01 2004.5 South Asia Low income FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PCGDP  LIFEEX GINI        ODA      POP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       NA 34.7055   NA  234900002  9850550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       NA 39.8430   NA  246509995 12551055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       NA 46.4005   NA   48539999 12071250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       NA 53.1200   NA  285175003 17593192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 361.2596 58.0310   NA 2984469971 25190480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 1 rows ]</span>
<span class="r-in"><span><span class="va">wlddev</span> <span class="op">|&gt;</span> <span class="fu"><a href="GRP.html">fgroup_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">decade</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">collapg</span><span class="op">(</span>custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fmean <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">12</span>, fmode <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">7</span>, flast <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       country decade       date decade     region     income    PCGDP  LIFEEX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Afghanistan   1960 1970-01-01   1960 South Asia Low income       NA 34.6908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Afghanistan   1970 1980-01-01   1970 South Asia Low income       NA 39.9053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Afghanistan   1980 1990-01-01   1980 South Asia Low income       NA 46.4176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Afghanistan   1990 2000-01-01   1990 South Asia Low income       NA 53.0097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Afghanistan   2000 2010-01-01   2000 South Asia Low income 379.3730 58.0881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Afghanistan   2010 2020-01-01   2010 South Asia Low income 567.4047 63.0715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GINI        ODA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   NA  222288999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   NA  236169998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   NA   71666001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   NA  317255000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   NA 3054051961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   NA 5023859033</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

